(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{535:function(t,a,i){},536:function(t,a,i){},714:function(t,a,i){"use strict";var e=i(535);i.n(e).a},715:function(t,a,i){"use strict";var e=i(536);i.n(e).a},904:function(t,a,i){"use strict";i.r(a);var e=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"live-mager email-box"},[i("div",{staticClass:"live-title"},[i("span",{staticClass:"title"},[t._v("邮件邀约")]),t._v(" "),i("com-back",{class:"back-btn"}),t._v(" "),i("button",{staticClass:"default-button fr",on:{click:t.addEmail}},[t._v("新建邮件")]),t._v(" "),i("span",{staticClass:"send-box fr"},[t._v("发送限额："+t._s(t.countBalance)+"/"+t._s(t.countTotal))])],1),t._v(" "),i("div",{directives:[{name:"ComLoading",rawName:"v-ComLoading",value:t.loading,expression:"loading"}],staticClass:"email-table-box"},[i("div",{staticClass:"tip-box"},[t._v("\n      通过邮件邀约，定制邀约邮件，邀请特定客户群参加直播活动\n    ")]),t._v(" "),i("div",{staticClass:"table-list-box",staticStyle:{"padding-top":"20px"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.emailList}},[i("el-table-column",{attrs:{prop:"title",label:"邮件标题"}}),t._v(" "),i("el-table-column",{attrs:{prop:"sendTime",label:"发送时间"}}),t._v(" "),i("el-table-column",{attrs:{prop:"sendCount",label:"发送数量"}}),t._v(" "),i("el-table-column",{attrs:{prop:"statusName",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(a){return["DRAFT"==a.row.status?i("span",{staticClass:"cg-status"},[t._v(t._s(a.row.statusName))]):t._e(),t._v(" "),"SEND"==a.row.status?i("span",{staticClass:"fs-status"},[t._v(t._s(a.row.statusName))]):t._e(),t._v(" "),"AWAIT"==a.row.status?i("span",{staticClass:"dd-status"},[t._v(t._s(a.row.statusName))]):t._e(),t._v(" "),"FAIL"==a.row.status?i("span",{staticClass:"del-status"},[t._v(t._s(a.row.statusName))]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[i("div",{staticClass:"table-handler"},[i("span",{on:{click:function(i){i.stopPropagation(),t.clickEmail(a.$index,t.handleType.info)}}},[t._v("查看")]),t._v(" "),"SEND"!==t.emailList[a.$index].status?i("span",{on:{click:function(i){i.stopPropagation(),t.clickEmail(a.$index,t.handleType.delete)}}},[t._v("删除")]):t._e()])]}}])})],1)],1),t._v(" "),i("div",{staticClass:"pagination-box"},[i("div",{staticClass:"page-pagination"},[i("ve-pagination",{attrs:{total:t.total,pageSize:t.pageSize},on:{changePage:t.changePage}})],1)])])])};e._withStripped=!0;var s=i(30),n=i.n(s),l=i(471),o=i(472),c=i(96),d=i(15),r={info:"queryInfoEmail",send:"sendEmail",edit:"editEmail",delete:"deleteEmail"},u={DRAFT:"草稿",SEND:"已发送",AWAIT:"等待发送",FAIL:"发送失败"},m={name:"index",components:{VePagination:o.a},data:function(){return{pageSize:10,total:0,currentPage:1,activeId:"",sendShow:!1,currentEmailIdx:"",handleType:r,loading:!1,emailList:[{activityId:0,emailInviteId:0,title:"",content:"",desc:"",planTime:"",sendTime:"",senderName:"",sendCount:0,status:"",statusName:""}],countTotal:0,countBalance:0}},computed:{currentEmail:function(){return this.emailList[this.currentEmailIdx]}},created:function(){var t=this.$route.params.id;t||this.$router.go(-1),this.activeId=t,this.getLimit(),this.queryEmailListById()},methods:n()({},Object(c.b)("liveMager",{storeEmailInfo:d.d}),{changePage:function(t){this.currentPage=t,this.queryEmailListById()},queryEmailListById:function(){var t=this;this.$get(l.a.GET_EMAIL_LIST,{activityId:this.activeId,pageSize:this.pageSize,page:this.currentPage}).then(function(a){a.data.list.map(function(t){return t.statusName=u[t.status],t.sendTime=t.sendTime||"--",t.title=t.title||"--",t}),t.total=a.data.total,t.emailList=a.data.list})},clickEmail:function(t,a){var i=this;this.currentEmailIdx=t,a===this.handleType.info?this.queryInfoEmail():a===this.handleType.edit?this.editEmail():a===this.handleType.send?this.sendShow=!0:a===this.handleType.delete&&this.$messageBox({header:"",content:"删除邮件后，邮件内容将无法找回，确认删除？",cancelText:"取消",confirmText:"删除",width:"400px",handleClick:function(t){"confirm"===t.action&&i.delEmail()}})},queryInfoEmail:function(){var t=this.emailList[this.currentEmailIdx];this.storeEmailInfo(t),this.$router.push("/liveMager/emailInfo/"+this.activeId+"?email="+t.emailInviteId)},sendEmail:function(){this.$post(l.a.POST_SEND_EMAIL_INFO,{emailInviteId:this.emailList[this.currentEmailIdx].emailInviteId}).then(function(t){console.log("邮件发送成功"),console.log(t)})},handleClickSendEmail:function(t){this.sendShow=!1,"confirm"===t.action&&this.sendEmail()},delEmail:function(){var t=this,a=this.emailList[this.currentEmailIdx].emailInviteId;this.$post(l.a.POST_DEL_EMAIL,{emailInviteId:a}).then(function(a){t.queryEmailListById()})},editEmail:function(){var t=this.emailList[this.currentEmailIdx];this.storeEmailInfo(t),this.$router.push("/liveMager/emailEdit/"+this.activeId+"?email="+t.emailInviteId)},addEmail:function(){this.$router.push("/liveMager/emailEditOne/"+this.activeId)},getLimit:function(){var t=this;this.$get(l.a.GET_SEND_LIMIT,{activityId:this.activeId,type:"EMAIL"}).then(function(a){console.log(a),t.countBalance=a.data.balance,t.countTotal=a.data.total})}})},h=(i(714),i(715),i(1)),v=Object(h.a)(m,e,[],!1,null,"6533cfb3",null);v.options.__file="src/pages/live-mager/email/index.vue";a.default=v.exports}}]);
//# sourceMappingURL=15.f279154f.js.map