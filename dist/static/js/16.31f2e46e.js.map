{"version":3,"sources":["webpack:///./src/pages/live-mager/email/edit-step-one.vue?9a7a","webpack:///./src/pages/live-mager/email/edit-step-one.vue?b94a","webpack:///src/pages/live-mager/email/edit-step-one.vue","webpack:///./src/pages/live-mager/email/edit-step-one.vue","webpack:///./src/pages/live-mager/css/live.scss?0d0b","webpack:///./src/pages/live-mager/email/edit-step-one.vue?72ec"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","keydown","$event","canPass","click","goBack","_v","model","value","email","content","callback","$$v","$set","expression","recoverDefault","_l","emailList","emailItem","idx","class","temp-item","fl","active","emailTemplateId","stopPropagation","changeTemp","style","backgroundColor","cover","_s","title","directives","name","rawName","testEmailShow","attrs","header","type","width","handleClick","emailHandleClick","testEmailAddress","error-tips","emailError","maxLength","placeholder","update:value","nativeOn","keyup","_k","keyCode","key","sendTestEmail","slot","testEmailCount","clickSendTestEmail","nextEmail","default-button","margin-fl","fr","disabled","isDisabled","saveEmail","_withStripped","email_edit_step_onevue_type_script_lang_js_","data","isHistory","activityId","emailInviteId","desc","senderName","PC_HOST","location","protocol","components","VeHtml5Editer","ve_html5_editer","computed","extends_default","Object","vuex_esm","emailInfo","state","beforeRouteEnter","to","from","next","vm","queryEmailTemp","initPage","beforeRouteLeave","$messageBox","cancelText","confirmText","e","action","watch","handler","newVal","immediate","created","methods","storeEmailInfo","mutation_types","queryId","$route","params","id","emailId","query","queryEmailInfo","$router","go","_this","$post","activity_service","POST_TEST_EMAIL_INFO","then","res","_this2","$get","GET_EMAIL_INFO","_this3","GET_EMAIL_TPL_LIST","list","replace","_this4","RegExp","test","POST_SEND_TEST_EMAIL_INFO","receiverEmail","$toast","position","autoClose","_this5","POST_SAVE_EMAIL_INFO","st","setTimeout","clearTimeout","push","_this6","_this7","i","length","emailObj","component","componentNormalizer","options","__file","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_node_modules_sass_loader_lib_loader_js_live_scss_vue_type_style_index_0_id_f4e271ae_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","n","_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_index_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_node_modules_sass_loader_lib_loader_js_node_modules_vue_loader_lib_index_js_vue_loader_options_edit_step_one_vue_vue_type_style_index_1_id_f4e271ae_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__"],"mappings":"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","file":"static/js/16.31f2e46e.js","sourcesContent":["var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      staticClass: \"edit-step-box\",\n      on: {\n        keydown: function($event) {\n          _vm.canPass = false\n        }\n      }\n    },\n    [\n      _c(\"header\", { staticClass: \"email-header\" }, [\n        _c(\n          \"div\",\n          { staticClass: \"back-btn-email\", on: { click: _vm.goBack } },\n          [_c(\"i\", { staticClass: \"iconfont icon-jiantou\" })]\n        ),\n        _vm._v(\" \"),\n        _c(\"span\", [_vm._v(\"步骤1 邮件内容\")])\n      ]),\n      _vm._v(\" \"),\n      _c(\"div\", { staticClass: \"border-box\" }, [\n        _c(\"div\", { staticClass: \"edit-content clearfix\" }, [\n          _c(\n            \"div\",\n            { staticClass: \"edit-content-box fl\" },\n            [\n              _c(\"ve-html5-editer\", {\n                model: {\n                  value: _vm.email.content,\n                  callback: function($$v) {\n                    _vm.$set(_vm.email, \"content\", $$v)\n                  },\n                  expression: \"email.content\"\n                }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\"div\", { staticClass: \"edit-content-temp fr\" }, [\n            _c(\"div\", { staticClass: \"temp-title\" }, [\n              _c(\"span\", [_vm._v(\"选择模板\")]),\n              _vm._v(\" \"),\n              _c(\n                \"button\",\n                {\n                  staticClass: \"default-button fr\",\n                  on: { click: _vm.recoverDefault }\n                },\n                [_vm._v(\"恢复默认\\n          \")]\n              )\n            ]),\n            _vm._v(\" \"),\n            _c(\n              \"div\",\n              { staticClass: \"temp-boxs\" },\n              _vm._l(_vm.emailList, function(emailItem, idx) {\n                return _c(\n                  \"div\",\n                  {\n                    class: {\n                      \"temp-item\": true,\n                      fl: true,\n                      active:\n                        emailItem.emailTemplateId == _vm.email.emailTemplateId\n                    },\n                    on: {\n                      click: function($event) {\n                        $event.stopPropagation()\n                        _vm.changeTemp(idx)\n                      }\n                    }\n                  },\n                  [\n                    _c(\"div\", {\n                      staticClass: \"temp-item-box\",\n                      style: { backgroundColor: emailItem.cover }\n                    }),\n                    _vm._v(\" \"),\n                    _c(\"span\", { staticClass: \"temp-item-title\" }, [\n                      _vm._v(_vm._s(emailItem.title))\n                    ])\n                  ]\n                )\n              })\n            )\n          ])\n        ])\n      ]),\n      _vm._v(\" \"),\n      _c(\n        \"message-box\",\n        {\n          directives: [\n            {\n              name: \"show\",\n              rawName: \"v-show\",\n              value: _vm.testEmailShow,\n              expression: \"testEmailShow\"\n            }\n          ],\n          attrs: { header: \"邮件测试发送\", type: \"prompt\", width: \"450px\" },\n          on: { handleClick: _vm.emailHandleClick }\n        },\n        [\n          _c(\n            \"div\",\n            { staticClass: \"email-box\" },\n            [\n              _c(\"span\", { staticClass: \"test-tip\" }, [\n                _vm._v(\"每天只允许发送5条测试邮件：\")\n              ]),\n              _vm._v(\" \"),\n              _c(\"com-input\", {\n                attrs: {\n                  value: _vm.testEmailAddress,\n                  \"error-tips\": _vm.emailError,\n                  maxLength: 40,\n                  placeholder: \"输入邮件地址\"\n                },\n                on: {\n                  \"update:value\": function($event) {\n                    _vm.testEmailAddress = $event\n                  }\n                },\n                nativeOn: {\n                  keyup: function($event) {\n                    if (\n                      !(\"button\" in $event) &&\n                      _vm._k($event.keyCode, \"enter\", 13, $event.key, \"Enter\")\n                    ) {\n                      return null\n                    }\n                    return _vm.sendTestEmail($event)\n                  }\n                }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"div\",\n            {\n              staticClass: \"step-one-btns\",\n              attrs: { slot: \"bottom\" },\n              slot: \"bottom\"\n            },\n            [\n              _c(\"span\", [_vm._v(\"邮件限额：\" + _vm._s(_vm.testEmailCount))]),\n              _vm._v(\" \"),\n              _c(\n                \"button\",\n                {\n                  staticClass: \"primary-button\",\n                  on: { click: _vm.sendTestEmail }\n                },\n                [_vm._v(\"立即发送\\n      \")]\n              )\n            ]\n          )\n        ]\n      ),\n      _vm._v(\" \"),\n      _c(\"div\", { staticClass: \"email-bottom\" }, [\n        _c(\n          \"button\",\n          {\n            staticClass: \"default-button fl\",\n            on: { click: _vm.clickSendTestEmail }\n          },\n          [_vm._v(\"发送测试邮件\\n    \")]\n        ),\n        _vm._v(\" \"),\n        _c(\n          \"button\",\n          { staticClass: \"primary-button fr\", on: { click: _vm.nextEmail } },\n          [_vm._v(\"下一步\\n    \")]\n        ),\n        _vm._v(\" \"),\n        _c(\n          \"button\",\n          {\n            class: {\n              \"default-button\": true,\n              \"margin-fl\": true,\n              fr: true,\n              disabled: _vm.isDisabled\n            },\n            on: { click: _vm.saveEmail }\n          },\n          [_vm._v(\"保存草稿\\n\\n    \")]\n        )\n      ])\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit-step-one.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit-step-one.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"edit-step-box\"\n       @keydown=\"canPass = false\">\n    <header class=\"email-header\">\n      <div class=\"back-btn-email\"\n           @click=\"goBack\">\n        <i class=\"iconfont icon-jiantou\"></i>\n      </div>\n      <span>步骤1 邮件内容</span>\n    </header>\n    <div class=\"border-box\">\n      <div class=\"edit-content clearfix\">\n        <div class=\"edit-content-box fl\">\n          <ve-html5-editer v-model=\"email.content\"></ve-html5-editer>\n        </div>\n        <div class=\"edit-content-temp fr\">\n          <div class=\"temp-title\">\n            <span>选择模板</span>\n            <button class=\"default-button fr\"\n                    @click=\"recoverDefault\">恢复默认\n            </button>\n          </div>\n          <div class=\"temp-boxs\">\n            <div v-for=\"(emailItem,idx) in emailList\"\n                 :class=\"{'temp-item':true,fl:true,active:emailItem.emailTemplateId==email.emailTemplateId}\"\n                 @click.stop=\"changeTemp(idx)\">\n              <div class=\"temp-item-box\"\n                   :style=\"{backgroundColor:emailItem.cover}\"></div>\n              <span class=\"temp-item-title\">{{emailItem.title}}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <!-- 发送测试邮件 -->\n    <message-box v-show=\"testEmailShow\"\n                 header=\"邮件测试发送\"\n                 type=\"prompt\"\n                 width=\"450px\"\n                 @handleClick=\"emailHandleClick\">\n      <div class=\"email-box\">\n        <span class=\"test-tip\">每天只允许发送5条测试邮件：</span>\n        <com-input :value.sync=\"testEmailAddress\"\n                   :error-tips=\"emailError\"\n                   :maxLength=\"40\"\n                   @keyup.enter.native=\"sendTestEmail\"\n                   placeholder=\"输入邮件地址\"/>\n      </div>\n      <div class=\"step-one-btns\"\n           slot=\"bottom\">\n        <span>邮件限额：{{testEmailCount}}</span>\n        <button class=\"primary-button\"\n                @click=\"sendTestEmail\">立即发送\n        </button>\n      </div>\n    </message-box>\n    <div class=\"email-bottom\">\n      <button class=\"default-button fl\"\n              @click=\"clickSendTestEmail\">发送测试邮件\n      </button>\n      <button class=\"primary-button fr\"\n              @click=\"nextEmail\">下一步\n      </button>\n      <button :class=\"{'default-button':true, 'margin-fl':true, fr:true,disabled:isDisabled}\"\n              @click=\"saveEmail\">保存草稿\n\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\n  import activityService from 'src/api/activity-service'\n  import VeHtml5Editer from 'src/components/ve-html5-editer'\n  import {\n    mapState,\n    mapMutations\n  } from 'vuex'\n  import * as types from '../../../store/mutation-types'\n\n  export default {\n    name: 'edit-step-one',\n    data () {\n      return {\n        testEmailShow: false,\n        testEmailAddress: '',\n        testEmailCount: 0,\n        emailError: '',\n        emailList: [],\n        isHistory: false,\n        email: {\n          activityId: '',\n          emailInviteId: '',\n          emailTemplateId: 1,\n          title: '',\n          content: '',\n          desc: '',\n          senderName: ''\n        },\n        isDisabled: false,\n        canPass: true,\n        PC_HOST: location.protocol + process.env.PC_HOST\n      }\n    },\n    components: {\n      VeHtml5Editer\n    },\n    computed: {\n      ...mapState('liveMager', {\n        emailInfo: state => state.emailInfo\n      })\n    },\n    /* 路由守卫，在路由跳转前执行，此时组件实例还没被创建 */\n    beforeRouteEnter (to, from, next) {\n      next(vm => {\n        if (from.name === 'emailEditTwo') {\n          /* 表示第二步进入第一步 */\n          vm.isHistory = true\n          vm.queryEmailTemp()\n        }\n        vm.initPage()\n      })\n    },\n    /* 路由守卫，离开当前页面之前被调用 */\n    beforeRouteLeave (to, from, next) {\n      if (this.canPass) {\n        next(true)\n        return false\n      }\n      this.$messageBox({\n        header: '提示',\n        width: '400px',\n        content: '是否放弃当前编辑？',\n        cancelText: '否',\n        confirmText: '是',\n        handleClick: (e) => {\n          if (e.action === 'confirm') {\n            next(true)\n          } else {\n            next(false)\n          }\n        }\n      })\n    },\n    watch: {\n      emailInfo: {\n        handler (newVal) {\n          this.email = {\n            ...this.email,\n            ...newVal\n          }\n        },\n        immediate: true\n      },\n      testEmailAddress () {\n        this.emailError = ''\n      }\n    },\n    created () {\n    },\n    methods: {\n      ...mapMutations('liveMager', {\n        storeEmailInfo: types.EMAIL_INFO\n      }),\n      initPage () {\n        if (this.isHistory && this.emailInfo.content) {\n          this.email = this.emailInfo\n          return\n        }\n        const queryId = this.$route.params.id\n        if (!queryId) {\n          this.$router.go(-1)\n          return\n        }\n        const emailId = this.$route.query.email\n        if (emailId) { // 编辑\n          // 如果vuex可以取到值就return\n          if (this.email.emailInviteId) {\n            this.queryEmailTemp()\n            return\n          }\n          this.email.emailInviteId = emailId\n          this.queryEmailInfo()\n        } else { // 新增\n          this.email = {\n            activityId: queryId,\n            emailInviteId: '',\n            emailTemplateId: 1,\n            title: '',\n            content: '',\n            desc: '',\n            senderName: ''\n          }\n          this.storeEmailInfo(this.email)\n        }\n        this.queryEmailTemp()\n      },\n      clickSendTestEmail () {\n        this.testEmailShow = true\n        this.$post(activityService.POST_TEST_EMAIL_INFO, {\n          type: 'email'\n        }).then((res) => {\n          this.canPass = true\n          this.testEmailCount = res.data\n        })\n      },\n      emailHandleClick (e) {\n        if (e.action === 'cancel') {\n          this.testEmailShow = false\n        }\n      },\n      /* 查询邮件详情 */\n      queryEmailInfo () {\n        // 如果不是编辑页面就return\n        if (!this.email.emailInviteId) return\n        this.$get(activityService.GET_EMAIL_INFO, {\n          emailInviteId: this.email.emailInviteId\n        }).then((res) => {\n          this.email = res.data\n          this.storeEmailInfo(this.email)\n        })\n      },\n      queryEmailTemp () {\n        this.$get(activityService.GET_EMAIL_TPL_LIST).then((res) => {\n          if (!res.data.list) return\n          this.emailList = res.data.list\n          if (!this.email.emailInviteId) { // 如果不是编辑\n            this.email.content = this.emailList[0].content.replace('$$activity$$', `${this.PC_HOST}subscribe/${this.email.activityId}?refer=0`)\n          }\n        })\n      },\n      sendTestEmail () {\n        if (!this.testEmailAddress) {\n          this.emailError = '邮箱不能为空'\n          return\n        } else {\n          const emailReg = new RegExp('^[a-z0-9]+([._\\\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$')\n          if (!emailReg.test(this.testEmailAddress)) {\n            this.emailError = '邮箱格式不正确'\n            return\n          }\n        }\n        if (!this.email.content) {\n          this.$messageBox({\n            header: '提示',\n            content: '邮件内容不能为空',\n            confirmText: '知道了',\n            autoClose: 10\n          })\n          return\n        }\n        this.testEmailShow = false\n        this.email.content = this.email.content.replace('$$activity$$', `${this.PC_HOST}subscribe/${this.email.activityId}?refer=0`)\n        this.$post(activityService.POST_SEND_TEST_EMAIL_INFO, {\n          content: this.email.content,\n          receiverEmail: this.testEmailAddress\n        }).then((res) => {\n          this.canPass = true\n          this.$toast({\n            content: '发送成功，请稍后查收邮件',\n            position: 'center'\n          })\n        })\n        // LiveHttp.sendTestEmailInfo({\n        //   content: this.email.content,\n        //   receiverEmail: this.testEmailAddress\n        // }).then((res) => {\n        //   if (res.code === 200) {\n        //     this.$toast({\n        //       header: `提示`,\n        //       content: '发送成功，请稍后查收邮件',\n        //       autoClose: 2000,\n        //       position: 'right-top'\n        //     })\n        //   }\n        // })\n      },\n      /* 保存草稿 */\n      saveEmail () {\n        this.isDisabled = true\n        this.canPass = true\n        this.email.content = this.email.content.replace('$$activity$$', `${this.PC_HOST}subscribe/${this.email.activityId}?refer=0`)\n        this.$post(activityService.POST_SAVE_EMAIL_INFO, this.email).then((res) => {\n          // 回写邮件id\n          if (!this.email.emailInviteId) {\n            this.$router.replace({\n              query: {\n                email: res.data.emailInviteId\n              }\n            })\n          }\n          this.email.emailInviteId = res.data.emailInviteId\n          this.email.title = res.data.title\n          // 把信息保存到vuex\n          this.storeEmailInfo(this.email)\n          this.$toast({\n            content: '保存草稿成功',\n            position: 'center'\n          })\n        })\n        let st = setTimeout(() => {\n          clearTimeout(st)\n          this.isDisabled = false\n        }, 3000)\n        // LiveHttp.saveEmailInfo(this.email).then((res) => {\n        //   // 回写邮件id\n        //   this.email.emailInviteId = res.data.emailInviteId\n        //   this.email.title = res.data.title\n        //   // 把信息保存到vuex\n        //   this.storeEmailInfo(this.email)\n        //   this.$toast({\n        //     header: `提示`,\n        //     content: '保存草稿成功',\n        //     autoClose: 2000,\n        //     position: 'right-top'\n        //   })\n        // })\n      },\n      goBack () {\n        this.$router.go(-1)\n      },\n      nextEmail () {\n        this.canPass = true\n        this.storeEmailInfo(this.email)\n        // 切换到下一步\n        this.$router.push(`/liveMager/emailEditTwo/${this.email.activityId}?email=${this.email.emailInviteId}`)\n      },\n      /* 更换模板 */\n      changeTemp (idx) {\n        this.$messageBox({\n          header: '',\n          width: '400px',\n          content: '更换邮件模板会导致已编辑的内容丢失',\n          cancelText: '取消',\n          confirmText: '确认替换',\n          handleClick: (e) => {\n            if (e.action === 'confirm') {\n              this.email.emailTemplateId = this.emailList[idx].emailTemplateId\n              this.email.content = this.emailList[idx].content.replace('$$activity$$', `${this.PC_HOST}subscribe/${this.email.activityId}?refer=0`)\n            }\n          }\n        })\n      },\n      /* 恢复默认模板 */\n      recoverDefault () {\n        this.$messageBox({\n          header: '',\n          width: '400px',\n          content: '恢复默认模板会导致已编辑的内容丢失',\n          cancelText: '取消',\n          confirmText: '恢复默认',\n          handleClick: (e) => {\n            if (e.action === 'confirm') {\n              for (let i = 0; i < this.emailList.length; i++) {\n                const emailObj = this.emailList[i]\n                if (emailObj.emailTemplateId === this.email.emailTemplateId) {\n                  this.email.content = emailObj.content.replace('$$activity$$', `${this.PC_HOST}subscribe/${this.email.activityId}?refer=0`)\n                  break\n                }\n              }\n            }\n          }\n        })\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped src=\"../css/live.scss\">\n</style>\n\n<style lang=\"scss\" scoped>\n@import 'assets/css/mixin.scss';\n\n.edit-step-box {\n  min-width: 1366px;\n  background-color: #fff;\n  color: #222;\n  .email-header {\n    height: 60px;\n    line-height: 60px;\n    background-color: #ffd021;\n    .icon-jiantou {\n      font-size: 22px;\n      vertical-align: -2px;\n    }\n    .back-btn-email {\n      display: inline-block;\n      padding: 0 15px;\n      background-color: #ffda51;\n      line-height: 40px;\n      border-radius: 4px;\n      font-size: 18px;\n      text-align: center;\n      margin-left: 20px;\n      margin-right: 10px;\n      &:hover {\n        cursor: pointer;\n        opacity: 0.9;\n        color: #4b5afe;\n      }\n    }\n  }\n  .email-bottom {\n    height: 60px;\n    line-height: 60px;\n    border-top: 1px solid #e2e2e2;\n    box-sizing: border-box;\n    box-shadow: 0 0 4px rgba(0, 0, 0, 0.1);\n    padding: 0 20px;\n    background-color: #fff;\n    button {\n      margin-top: 10px;\n    }\n    .margin-fl {\n      margin-right: 10px;\n    }\n  }\n  .border-box /deep/ {\n    height: calc(100vh - 120px);\n    .html-editer {\n      height: 100%;\n      .vue-html5-editor .content {\n        background-color: #f5f5f5;\n      }\n    }\n  }\n  .step-btns {\n    margin: 30px 30px 100px 30px;\n    .margin-fl {\n      margin: 0 20px;\n    }\n  }\n  .edit-content {\n    height: 100%;\n    margin: 0 0 20px 0;\n    .edit-content-temp {\n      height: calc(100% - 36px);\n      width: 356px;\n      margin-top: 36px;\n      padding: 0 1.8%;\n      box-sizing: border-box;\n      overflow-y: scroll;\n      .temp-title {\n        span {\n          line-height: 44px;\n          color: #555;\n        }\n      }\n      .temp-boxs {\n        margin-top: 20px;\n        .temp-item {\n          width: 124px;\n          margin: 10px 15px;\n          text-align: center;\n          &:nth-child(2n) {\n            margin-right: 0;\n          }\n          &:nth-child(2n + 1) {\n            margin-left: 0;\n          }\n          .temp-item-box {\n            height: 196px;\n            box-sizing: border-box;\n            border: solid 1px #e5e5e5;\n            border-radius: 4px;\n            background-size: cover;\n            &:hover {\n              cursor: pointer;\n              border-color: #4b5afe;\n              transition: border-color 0.2s;\n            }\n          }\n          .temp-item-title {\n            display: block;\n            padding-top: 5px;\n            font-size: 14px;\n            color: #555555;\n          }\n          &:nth-child(1) .temp-item-box {\n            background-image: url('../../../assets/image/email-01.jpg');\n          }\n          &:nth-child(2) .temp-item-box {\n            background-image: url('../../../assets/image/email-02.jpg');\n          }\n          &:nth-child(3) .temp-item-box {\n            background-image: url('../../../assets/image/email-03.jpg');\n          }\n          &:nth-child(4) .temp-item-box {\n            background-image: url('../../../assets/image/email-04.jpg');\n          }\n        }\n        .active {\n          .temp-item-box {\n            border-color: #4b5afe;\n          }\n        }\n      }\n    }\n    .edit-content-box /deep/ {\n      width: calc(100% - 356px);\n      height: 100%;\n      .vue-html5-editor {\n        height: 100%;\n        border: none;\n        border-right: solid 1px #e5e5e5;\n        border-radius: 0;\n        .content {\n          height: calc(100% - 37px);\n          max-height: calc(100% - 37px);\n          padding: 0;\n        }\n      }\n    }\n  }\n  .email-box {\n    width: 100%;\n    margin: 15px 10px;\n    .test-tip {\n      font-size: 14px;\n      color: #4b5afe;\n      line-height: 40px;\n    }\n    .com-input {\n      width: 390px;\n    }\n  }\n  .step-one-btns {\n    margin: 40px 10px -10px 10px;\n    span {\n      float: left;\n      line-height: 45px;\n      font-size: 14px;\n      color: #888;\n    }\n  }\n}\n</style>\n","import { render, staticRenderFns } from \"./edit-step-one.vue?vue&type=template&id=f4e271ae&scoped=true&\"\nimport script from \"./edit-step-one.vue?vue&type=script&lang=js&\"\nexport * from \"./edit-step-one.vue?vue&type=script&lang=js&\"\nimport style0 from \"../css/live.scss?vue&type=style&index=0&id=f4e271ae&lang=scss&scoped=true&\"\nimport style1 from \"./edit-step-one.vue?vue&type=style&index=1&id=f4e271ae&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f4e271ae\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/chenqi/Desktop/Wswork/fe_management/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('f4e271ae', component.options)\n    } else {\n      api.reload('f4e271ae', component.options)\n    }\n    module.hot.accept(\"./edit-step-one.vue?vue&type=template&id=f4e271ae&scoped=true&\", function () {\n      api.rerender('f4e271ae', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pages/live-mager/email/edit-step-one.vue\"\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader/index.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js!../../../../node_modules/sass-loader/lib/loader.js!./live.scss?vue&type=style&index=0&id=f4e271ae&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader/index.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js!../../../../node_modules/sass-loader/lib/loader.js!./live.scss?vue&type=style&index=0&id=f4e271ae&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader/index.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit-step-one.vue?vue&type=style&index=1&id=f4e271ae&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../node_modules/css-loader/index.js!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js!../../../../node_modules/sass-loader/lib/loader.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit-step-one.vue?vue&type=style&index=1&id=f4e271ae&lang=scss&scoped=true&\""],"sourceRoot":""}