(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{173:function(e,t,s){},176:function(e,t,s){"use strict";var a=s(5);const i={getCodeId:e=>a.a.ajax({method:"post",url:"/common/sms/get-captchaid",params:e}),getCode:e=>a.a.ajax({method:"post",url:"/common/sms/send-code",params:e})};t.a=i},177:function(e,t,s){"use strict";var a=s(173);s.n(a).a},179:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("com-upload",{attrs:{accept:e.accept,actionUrl:"/api/upload/do-upload",inputName:"file",fileSize:e.fileSize},on:{error:e.uploadError,progress:e.uploadProgress,load:e.uploadImgSuccess}},[s("div",{staticClass:"upload-file-box",attrs:{title:"点击上传"}},[e.percentImg?s("el-progress",{attrs:{type:"circle",percentage:e.percentImg}}):e._e(),e._v(" "),s("i",{staticClass:"iconfont icon-jiahao"}),e._v(" "),s("span",[e._v(e._s(e.tipTxt))]),e._v(" "),e.fileSrc||e.coverImg?s("div",{staticClass:"upload-file-botton",on:{click:function(t){return t.stopPropagation(),e.deleteImage(t)}}},[e._v("删除")]):e._e(),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.fileSrc?s("div",{staticClass:"temp-img",style:{backgroundImage:"url("+e.imgHost+"/"+e.fileSrc+")"}}):e._e(),e._v(" "),!e.fileSrc&&e.coverImg?s("div",{staticClass:"temp-img",style:{backgroundImage:"url("+e.coverImg+")"}}):e._e()])],1)])};a._withStripped=!0;var i={name:"ve-upload",components:{ComUpload:s(41).a},data:()=>({imgHost:"",fileSrc:"",coverImg:"",tipTxt:"",percentImg:0}),props:{accept:{type:String,default:"png|jpg|jpeg|bmp|gif|doc|mp4"},fileSize:{type:Number,default:1024},defaultImg:{type:String,default:""},title:{type:String,default:"上传文件"}},watch:{defaultImg:{handler(e){this.coverImg=e},immediate:!0},title:{handler(e){this.tipTxt=e},immediate:!0}},methods:{deleteImage(){this.coverImg="",this.fileSrc="",this.$emit("success",{name:"",host:""})},uploadProgress(e){this.percentImg=parseFloat(parseFloat(e.percent.replace("%","")).toFixed(2)),100===this.percentImg&&(this.percentImg=0)},uploadImgSuccess(e){const t=JSON.parse(e.data).data;t.host&&(this.imgHost=t.host),t.name&&(this.fileSrc=t.name),this.$emit("success",t)},uploadError(e){this.fileSrc="",this.$emit("error",e)}}},o=(s(177),s(1)),n=Object(o.a)(i,a,[],!1,null,null,null);n.options.__file="src\\components\\ve-upload.vue";t.a=n.exports},180:function(e,t,s){"use strict";var a=s(5);const i={register:e=>a.a.ajax({method:"post",url:"/user/business-user/reg",params:e}),loginByPhone:e=>a.a.ajax({method:"post",url:"/user/business-user/mobile-login",params:e}),loginByAccount:e=>a.a.ajax({method:"post",url:"/user/business-user/account-login",params:e}),logOff:e=>a.a.ajax({method:"post",url:"/user/business-user/signout",params:e})};t.a=i},200:function(e,t,s){},201:function(e,t,s){},275:function(e,t,s){"use strict";var a=s(200);s.n(a).a},277:function(e,t,s){"use strict";var a=s(201);s.n(a).a},356:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"account-container"},[s("div",{staticClass:"v-info"},[s("p",{staticClass:"v-title"},[e._v("\n      基本信息\n    ")]),e._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.logOff()}}},[e._v("退出登录")]),e._v(" "),s("com-editor",{attrs:{value:e.account,type:"readOnly"},on:{"update:value":function(t){e.account=t}}},[s("span",{staticClass:"v-explain"},[e._v("账号")])]),e._v(" "),s("com-editor",{attrs:{value:e.accountName,type:"input",clickType:"save",maxLength:40},on:{"update:value":function(t){e.accountName=t},saveInfo:function(t){e.save(e.accountName,"name","company")}}},[s("span",{staticClass:"v-explain"},[e._v("账户名")])]),e._v(" "),s("div",{staticClass:"v-editor",staticStyle:{height:"170px"}},[s("span",{staticClass:"v-explain",staticStyle:{"vertical-align":"top"}},[e._v("账户头像")]),e._v(" "),s("ve-upload",{attrs:{title:"上传封面",accept:"png|jpg|jpeg|bmp|gif",defaultImg:e.$imgHost+"/"+e.avatar,fileSize:1024},on:{error:e.uploadError,success:e.uploadImgSuccess}})],1),e._v(" "),s("com-editor",{attrs:{value:e.accountPhone,type:"input",clickType:"popup"},on:{"update:value":function(t){e.accountPhone=t},clickSaveBtn:function(t){e.clickSave(e.accountPhone,"popup","mobliePhone")}}},[s("span",{staticClass:"v-explain"},[e._v("注册手机")])]),e._v(" "),s("com-editor",{attrs:{value:e.accountPassword,type:"input",clickType:"popup"},on:{"update:value":function(t){e.accountPassword=t},clickSaveBtn:function(t){e.clickSave(e.accountPassword,"popup","password")}}},[s("span",{staticClass:"v-explain"},[e._v("登录密码")])]),e._v(" "),s("com-editor",{attrs:{value:e.companyName,type:"readOnly"},on:{"update:value":function(t){e.companyName=t}}},[s("span",{staticClass:"v-explain"},[e._v("公司名称")])]),e._v(" "),s("com-editor",{attrs:{value:e.state,type:"input",clickType:"popup",btnName:"查看"},on:{"update:value":function(t){e.state=t},clickSaveBtn:function(t){e.clickSave(e.state,"popup","state")}}},[s("span",{staticClass:"v-explain"},[e._v("认证状态")])]),e._v(" "),s("com-editor",{attrs:{value:e.selectIndustry,type:"select",selectValue:e.industry,clickType:"save"},on:{"update:value":function(t){e.selectIndustry=t},saveInfo:function(t){e.save(e.selectIndustry,"industry","company")}}},[s("span",{staticClass:"v-explain"},[e._v("所属行业")])]),e._v(" "),s("com-editor",{attrs:{value:e.companyWebsite,type:"input",clickType:"save","max-length":40},on:{"update:value":function(t){e.companyWebsite=t},saveInfo:function(t){e.save(e.companyWebsite,"website","company")}}},[s("span",{staticClass:"v-explain"},[e._v("公司网址")])])],1),e._v(" "),s("div",{staticClass:"v-info"},[s("p",{staticClass:"v-title"},[e._v("\n      指定联系人\n    ")]),e._v(" "),s("com-editor",{attrs:{value:e.userName,type:"input",clickType:"save","max-length":20},on:{"update:value":function(t){e.userName=t},saveInfo:function(t){e.save(e.userName,"name","user")}}},[s("span",{staticClass:"v-explain"},[e._v("姓名")])]),e._v(" "),s("com-editor",{attrs:{value:e.userPost,type:"input",clickType:"save","max-length":20},on:{"update:value":function(t){e.userPost=t},saveInfo:function(t){e.save(e.userPost,"position","user")}}},[s("span",{staticClass:"v-explain"},[e._v("职务")])]),e._v(" "),s("com-editor",{attrs:{value:e.userPhone,type:"input",clickType:"save","max-length":11},on:{"update:value":function(t){e.userPhone=t},saveInfo:function(t){e.save(e.userPhone,"mobile","user")}}},[s("span",{staticClass:"v-explain"},[e._v("手机")])]),e._v(" "),s("com-editor",{attrs:{value:e.officeNo,type:"input",clickType:"save","max-length":12},on:{"update:value":function(t){e.officeNo=t},saveInfo:function(t){e.save(e.officeNo,"tel","user")}}},[s("span",{staticClass:"v-explain"},[e._v("办公电话")])]),e._v(" "),s("com-editor",{attrs:{value:e.userEmail,type:"input",clickType:"save"},on:{"update:value":function(t){e.userEmail=t},saveInfo:function(t){e.save(e.userEmail,"email","user")}}},[s("span",{staticClass:"v-explain"},[e._v("邮箱")])]),e._v(" "),s("com-editor",{attrs:{value:e.userWechat,type:"input",clickType:"save","max-length":40},on:{"update:value":function(t){e.userWechat=t},saveInfo:function(t){e.save(e.userWechat,"wechat","user")}}},[s("span",{staticClass:"v-explain"},[e._v("微信")])]),e._v(" "),s("com-editor",{attrs:{value:e.userQQ,type:"input",clickType:"save","max-length":20},on:{"update:value":function(t){e.userQQ=t},saveInfo:function(t){e.save(e.userQQ,"qq","user")}}},[s("span",{staticClass:"v-explain"},[e._v("QQ")])]),e._v(" "),s("com-editor",{attrs:{value:e.userRemarks,type:"input",clickType:"save","max-length":60},on:{"update:value":function(t){e.userRemarks=t},saveInfo:function(t){e.save(e.userRemarks,"remark","user")}}},[s("span",{staticClass:"v-explain"},[e._v("备注")])])],1),e._v(" "),s("message-box",{directives:[{name:"show",rawName:"v-show",value:e.messageBoxShow,expression:"messageBoxShow"}],staticClass:"message-box",attrs:{width:"480px",confirmText:e.confirmText},on:{handleClick:e.messageBoxClick}},[s("div",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.messageBoxTitle))]),e._v(" "),"changeMobile"!==e.messageBoxType||"initialPhone"!==e.step&&"newPhone"!==e.step?e._e():s("div",[s("p",{staticClass:"v-explain"},[e._v("\n        "+e._s(e.messageBoxExplain)+"\n      ")]),e._v(" "),s("p",{staticClass:"v-subtitle"},[e._v("\n        安全验证\n      ")]),e._v(" "),e.isOldphone?s("com-input",{staticClass:"v-input",attrs:{value:e.phone,placeholder:"输入原有注册手机号",type:"input","max-length":11},on:{"update:value":function(t){e.phone=t}}}):e._e(),e._v(" "),e.isOldphone?e._e():s("com-input",{staticClass:"v-input",attrs:{value:e.newPhone,placeholder:"输入新手机号",type:"input","max-length":11},on:{"update:value":function(t){e.newPhone=t}}}),e._v(" "),s("div",{attrs:{id:"captcha"}}),e._v(" "),s("com-input",{staticClass:"v-input phone-code",attrs:{value:e.phoneCode,placeholder:"输入验证码",type:"input","max-length":6},on:{"update:value":function(t){e.phoneCode=t}}}),e._v(" "),s("a",{staticClass:"phone-code-btn",class:{prohibit:e.isProhibit},attrs:{href:"javascript:;"},on:{click:function(t){e.getCode()}}},[e._v("获取动态码"),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isSend,expression:"isSend"}],staticClass:"fr"},[e._v("("),s("em",[e._v(e._s(e.second))]),e._v("s)")])])],1),e._v(" "),"changeMobile"===e.messageBoxType&&"phoneSuccess"===e.step?s("div",[s("p",{staticClass:"v-explain"},[e._v("\n        修改成功\n      ")]),e._v(" "),s("p",{staticClass:"v-success"},[e._v("\n        您的注册手机更换为\n      ")]),e._v(" "),s("p",{staticClass:"v-mobile"},[e._v("\n        "+e._s(e.newPhone)+"\n      ")])]):"changePassword"===e.messageBoxType?s("div",[s("com-input",{staticClass:"v-input",attrs:{value:e.oldPassword,placeholder:"请输入旧密码",type:"password","max-length":30},on:{"update:value":function(t){e.oldPassword=t}}}),e._v(" "),s("com-input",{staticClass:"v-input",attrs:{value:e.newPassword,placeholder:"请输入新密码",type:"password","max-length":30},on:{"update:value":function(t){e.newPassword=t}}}),e._v(" "),s("p",{staticClass:"v-passordExplain"},[e._v("\n        支持6~30位的大小写英文和数字\n      ")]),e._v(" "),s("com-input",{staticClass:"v-input",attrs:{value:e.reNewPassword,placeholder:"请再次输入新密码",type:"password","max-length":30},on:{"update:value":function(t){e.reNewPassword=t}}}),e._v(" "),s("p",{staticClass:"v-passordExplain"},[e._v("\n        支持6~30位的大小写英文和数字\n      ")])],1):"seeState"===e.messageBoxType?s("div",[s("p",{staticClass:"v-state-info"},[s("span",{staticClass:"v-label"},[e._v("公司名称")]),s("span",{staticClass:"v-information"},[e._v(e._s(e.companyName))])]),e._v(" "),s("p",{staticClass:"v-state-info"},[s("span",{staticClass:"v-label"},[e._v("营业执照编号")]),s("span",{staticClass:"v-information"},[e._v(e._s(e.licenseCode))])]),e._v(" "),s("p",{staticClass:"v-state-info"},[s("span",{staticClass:"v-label"},[e._v("营业执照照片")]),e._v(" "),s("img",{attrs:{src:"licensePic",alt:"123"}})])]):e._e()])],1)};a._withStripped=!0;var i=s(57),o=s.n(i),n=s(11),c=s.n(n),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v-editor"},[e._t("default"),e._v(" "),e.isEdit?"readOnly"!==e.type?["select"===e.type?s("el-select",{attrs:{value:e.inputValue,placeholder:"请选择"},on:{"update:value":function(t){e.inputValue=t}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},e._l(e.selectValue,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})):"input"===e.type?s("com-input",{staticClass:"v-input",attrs:{value:e.inputValue,placeholder:"",type:"input","max-length":e.maxLength},on:{"update:value":function(t){e.inputValue=t}}}):e._e()]:e._e():s("span",{staticClass:"v-info-label"},[e._v(e._s(""===e.value?"无":e.value))]),e._v(" "),"readOnly"!==e.type?[e.isEdit&&"save"===e.clickType?e._e():s("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.modify(e.clickType)}}},[""===e.value&&""===e.btnName?s("span",[e._v("完善")]):""!==e.value&&""===e.btnName?s("span",[e._v("修改")]):""!==e.btnName?s("span",[e._v(e._s(e.btnName))]):e._e()]),e._v(" "),e.isEdit&&"save"===e.clickType?s("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.save()}}},[e._v("保存")]):e._e(),e._v(" "),e.isEdit&&"save"===e.clickType?s("a",{attrs:{href:"javascript:;"},on:{click:e.cancle}},[e._v("取消")]):e._e()]:e._e()],2)};l._withStripped=!0;var r={props:{value:String,type:String,selectValue:Array,clickType:String,btnName:{type:String,default:""},maxLength:Number},data:()=>({inputValue:"",isEdit:!1}),created(){this.inputValue=this.value},methods:{modify(e){"save"===e?this.isEdit=!0:this.$emit("clickSaveBtn",this.value)},save(){this.$emit("saveInfo",this.value),this.isEdit=!1},cancle(){this.isEdit=!1}},watch:{inputValue:{handler(e){this.$emit("update:value",e)},immediate:!0}}},p=(s(275),s(1)),u=Object(p.a)(r,l,[],!1,null,"347a5a94",null);u.options.__file="src\\pages\\account\\info-editor.vue";var h=u.exports,v=s(54),d=s(180),m=s(176),g=s(179),f=s(18),_=s(8),y={data:()=>({account:"",accountName:"",selectIndustry:"",accountPhone:"",accountPassword:"",companyName:"",state:"",industry:[{value:"黄金糕",label:"黄金糕"},{value:"双皮奶",label:"双皮奶"},{value:"蚵仔煎",label:"蚵仔煎"},{value:"龙须面",label:"龙须面"},{value:"北京烤鸭",label:"北京烤鸭"}],companyWebsite:"",userName:"",userPost:"",userPhone:"",officeNo:"",userEmail:"",userWechat:"",userQQ:"",userRemarks:"",confirmText:"",messageBoxShow:!1,messageBoxTitle:"更换手机",messageBoxExplain:"",messageBoxType:"changeMobile",step:"initialPhone",key:"",isProhibit:!0,isSend:!1,second:60,timerr:"",phoneKey:"",isImg:!1,cap:null,phone:"",isOldphone:!0,newPhone:"",token:"",codeToken:"",phoneStatus:!1,phoneCode:"",oldPassword:"",newPassword:"",reNewPassword:"",licenseCode:"",licensePic:"",avatar:""}),mounted(){this.getAccount(),v.a.getUserInfo({}).then(e=>{if(200!==e.code)console.log(e.msg);else{let t=e.data;this.userName=t.name,this.userPost=t.position,this.userPhone=t.mobile,this.officeNo=t.tel,this.userEmail=t.email,this.userWechat=t.wechat,this.userQQ=t.qq,this.userRemarks=t.remark}}),m.a.getCodeId({}).then(e=>{200!==e.code?console.log(e.msg):this.key=e.data})},computed:Object(f.mapState)("login",{isLogin:e=>e.isLogin}),components:{"com-editor":h,"ve-upload":g.a},created(){},watch:{phone:function(){this.checkPhone(this.phone)},phoneStatus:function(e){this.isGetCodePermission()},isImg:function(e){this.isGetCodePermission()}},methods:c()({},Object(f.mapMutations)("login",{setIsLogin:_.c}),{logOff(){d.a.logOff({}).then(e=>{200!==e.code?console.log(e.msg):(sessionStorage.removeItem("isLogin"),sessionStorage.removeItem("userInfo"),this.setIsLogin(0),console.log("账号退出成功"))})},getAccount(){v.a.getAccount({}).then(e=>{if(200!==e.code)console.log(e.msg);else{let t=e.data;this.account=t.userName,this.accountName=t.name,this.avatar=t.avatar,this.accountPhone=t.mobile,this.accountPassword=t.hasPassword?"已设置":"",this.companyName=t.company,this.state="AWAIT"===t.verify?"未认证":"已认证",this.selectIndustry=t.industry,this.companyWebsite=e.website,this.licenseCode=e.licenseCode,this.licensePic=e.licensePic,sessionStorage.setItem("userInfo",o()(e.data))}})},uploadImgSuccess(e){let t={avatar:""};e.host&&e.name&&(t={avatar:e.name}),v.a.setCompanyInfo(t).then(e=>{200!==e.code?alert(e.msg):(this.getAccount(),alert("更新成功"))})},uploadError(e){console.log("上传失败:",e)},save(e,t,s){let a={};a[t]=e,"company"===s?v.a.setCompanyInfo(a).then(e=>{200!==e.code?alert(e.msg):(this.getAccount(),alert("更新成功"))}):"user"===s&&v.a.setUserInfo(a).then(e=>{200!==e.code?alert(e.msg):alert("更新成功")})},clickSave(e,t,s){switch(console.log(e+"..."+t),"popup"===t&&(this.messageBoxShow=!0),s){case"mobliePhone":this.messageBoxType="changeMobile",this.phone=e,this.messageBoxExplain="为了保证您的账号安全，更换手机前请先进行安全验证",this.isOldphone=!0,this.step="initialPhone";let a=this;window.initNECaptcha({captchaId:a.key,element:"#captcha",mode:"float",width:435,onReady:function(e){},onVerify:function(e,t){t&&(a.phoneKey=t.validate,a.isImg=!0),e&&console.log(e)},onError:function(e){console.log(e)}},function(e){a.cap=e}),this.confirmText="提交",this.messageBoxTitle="更换手机",clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="";break;case"password":this.messageBoxType="changePassword",this.oldPassword="",this.newPassword="",this.reNewPassword="",this.confirmText="提交",this.messageBoxTitle="修改密码";break;case"state":this.messageBoxType="seeState",this.confirmText="确定",this.messageBoxTitle="认证信息"}},messageBoxClick(e){if("cancel"===e.action)console.log("取消或者关闭按钮"),this.messageBoxShow=!1;else if("confirm"===e.action)if("changeMobile"===this.messageBoxType)if("initialPhone"===this.step){let e={mobile:this.phone,code:this.phoneCode,type:"BUSINESS_USER_UPDATE_MOBILE"};v.a.verifyMobile(e).then(e=>{200!==e.code?console.log(e.msg):(this.token=e.data.codeToken,this.phone="",this.messageBoxExplain="验证成功，请输入新的手机号",this.isOldphone=!1,this.step="newPhone",clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="",this.cap.refresh())})}else if("newPhone"===this.step){let e={mobile:this.newPhone,token:this.token,code:this.code};v.a.updateMobile(e).then(e=>{200!==e.code?console.log(e.msg):(this.phone="",this.step="phoneSuccess")})}else"phoneSuccess"===this.step&&(this.messageBoxExplain="修改成功",this.step="initialPhone");else if("changePassword"===this.messageBoxType){if(this.newPassword!==this.reNewPassword)return alert("新密码与重新输入密码错误"),!1;let e={mobile:this.accountPhone,newPassword:this.newPassword,oldPassword:this.oldPassword};v.a.changePassword(e).then(e=>{200!==e.code?alert(e.msg):(alert("success"),this.oldPassword="",this.newPassword="",this.reNewPassword="")}),this.messageBoxShow=!1}else"seeState"===this.messageBoxType&&(this.messageBoxShow=!1)},isGetCodePermission(){console.log("isImg:"+this.isImg),console.log("phoneStatus:"+this.phoneStatus),this.isImg&&this.phoneStatus?this.isProhibit=!1:this.isProhibit=!0},checkPhone(e){/^1[3|4|5|6|7|8|9][0-9]\d{8}$/.test(parseInt(e))?this.phoneStatus=!0:this.phoneStatus=!1},getCode(){if(this.isProhibit)return!1;let e={mobile:this.phone,type:"BUSINESS_USER_UPDATE_MOBILE",captcha:this.phoneKey};m.a.getCode(e).then(e=>{200!==e.code?(this.error=e.msg,this.opacity=1,clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="",this.cap.refresh()):(this.isSend=!0,this.isProhibit=!0,clearInterval(this.timerr),this.timerr=setInterval(()=>{this.second--,this.second<=0&&(clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="",this.cap.refresh())},1e3))})}})},x=(s(277),Object(p.a)(y,a,[],!1,null,"52a11e9c",null));x.options.__file="src\\pages\\account\\index.vue";t.default=x.exports}}]);
//# sourceMappingURL=12.89c3004c.js.map