(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{176:function(t,s,e){"use strict";var i=e(5);const o={getCodeId:t=>i.a.ajax({method:"post",url:"/common/sms/get-captchaid",params:t}),getCode:t=>i.a.ajax({method:"post",url:"/common/sms/send-code",params:t})};s.a=o},199:function(t,s,e){},273:function(t,s,e){"use strict";var i=e(199);e.n(i).a},359:function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"clearfix forgot-container"},[e("img",{attrs:{src:"",alt:"logo"}}),t._v(" "),e("p",{staticClass:"v-title"},[t._v("\n      找回密码\n    ")]),t._v(" "),e("com-tabs",{attrs:{value:t.activeName,disabled:""},on:{"update:value":function(s){t.activeName=s}}},[e("com-tab",{attrs:{label:"用户管理",index:"first"}},[e("div",{staticClass:"v-get-password"},[e("com-input",{staticClass:"v-input",class:{warning:t.isWarning},attrs:{value:t.userPhone,placeholder:"输入手机号",maxLength:11},on:{"update:value":function(s){t.userPhone=s},inputFocus:function(s){t.inputFocus()}}}),t._v(" "),e("div",{attrs:{id:"captcha"}}),t._v(" "),e("com-input",{staticClass:"v-input phone-code",class:{warning:t.isWarning},attrs:{value:t.phoneCode,placeholder:"动态密码",maxLength:6},on:{"update:value":function(s){t.phoneCode=s},inputFocus:function(s){t.inputFocus()}}}),t._v(" "),e("a",{staticClass:"v-getcode",class:{prohibit:t.isProhibit},attrs:{href:"javascript:;"},on:{click:function(s){t.getCode()}}},[t._v("获取动态码"),e("span",{directives:[{name:"show",rawName:"v-show",value:t.isSend,expression:"isSend"}],staticClass:"fr"},[t._v("("),e("em",[t._v(t._s(t.second))]),t._v("s)")])]),t._v(" "),e("div",{staticClass:"input-form v-label",style:{opacity:t.opacity}},[e("p",{staticClass:"v-error"},[t._v(t._s(t.error))])]),t._v(" "),e("el-button",{on:{click:t.verifyUser}},[t._v("wo")])],1)]),t._v(" "),e("com-tab",{attrs:{label:"配置管理",index:"second"}},[e("div",{staticClass:"v-get-password"},[e("com-input",{staticClass:"v-input",class:{warning:t.isWarning},attrs:{value:t.password,placeholder:"新登录密码",maxLength:30,type:"password"},on:{"update:value":function(s){t.password=s},inputFocus:function(s){t.inputFocus()}}}),t._v(" "),e("com-input",{staticClass:"v-input",class:{warning:t.isWarning},attrs:{value:t.rePassword,placeholder:"确认新密码",maxLength:30,type:"password"},on:{"update:value":function(s){t.rePassword=s},inputFocus:function(s){t.inputFocus()}}}),t._v(" "),e("div",{staticClass:"input-form v-label",style:{opacity:t.opacity}},[e("p",{staticClass:"v-error"},[t._v(t._s(t.error))])]),t._v(" "),e("el-button",{on:{click:t.undatePhone}},[t._v("wo")])],1)]),t._v(" "),e("com-tab",{attrs:{label:"角色管理",index:"third"}},[t._v("\n         成功\n       ")])],1)],1)};i._withStripped=!0;var o=e(54),a=e(176),n={data:()=>({tabValue:1,outValue:"123",userPhone:"",phoneCode:"",token:"",activeName:"first",isWarning:!1,phoneStatus:!1,type:"password",key:"",isProhibit:!0,isSend:!1,second:60,timerr:"",phoneKey:"",isImg:!1,cap:null,opacity:0,error:"",password:"",rePassword:"",isValidPassword:!1}),components:{},created(){a.a.getCodeId({}).then(t=>{if(200!==t.code)console.log(t.msg);else{let s=this;this.key=t.data,window.initNECaptcha({captchaId:s.key,element:"#captcha",mode:"float",width:300,onReady:function(t){},onVerify:function(t,e){e&&(s.phoneKey=e.validate,s.isImg=!0),t&&console.log(t)},onError:function(){}},function(t){s.cap=t})}})},mounted(){},watch:{userPhone:function(){this.checkPhone(this.userPhone),this.isGetCodePermission()},phoneStatus:function(t){this.isGetCodePermission()},isImg:function(t){this.isGetCodePermission()}},methods:{setPassword(){console.log(1)},isGetCodePermission(){this.isImg&&this.phoneStatus?this.isProhibit=!1:this.isProhibit=!0},checkPhone(t){/^1[3|4|5|6|7|8|9][0-9]\d{8}$/.test(parseInt(t))?this.phoneStatus=!0:this.phoneStatus=!1},getCode(){if(this.isProhibit)return!1;let t={mobile:this.userPhone,type:"BUSINESS_USER_UPDATE_PASSWORD",captcha:this.phoneKey};a.a.getCode(t).then(t=>{200!==t.code?(this.error=t.msg,this.opacity=1,clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="",this.cap.refresh()):(this.isSend=!0,this.isProhibit=!0,clearInterval(this.timerr),this.timerr=setInterval(()=>{this.second--,this.second<=0&&(clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="",this.cap.refresh())},1e3))})},verifyUser(){if(!this.phoneStatus)return!1;let t={mobile:this.userPhone,code:this.phoneCode,type:"BUSINESS_USER_UPDATE_PASSWORD"};o.a.verifyMobile(t).then(t=>{200!==t.code?(this.error=t.msg,this.opacity=1):(this.activeName="second",this.token=t.data.codeToken,this.phone="",this.messageBoxExplain="验证成功，请输入新的手机号",this.isOldphone=!1,this.step="newPhone",clearInterval(this.timerr),this.isSend=!1,this.isProhibit=!0,this.second=60,this.isImg=!1,this.phoneKey="",this.cap.refresh())})},undatePhone(){if(this.password!==this.rePassword)this.error="两次密码输入不一致",this.opacity=1;else if(this.validPassword()){let t={mobile:this.userPhone,codeToken:this.token,newPassword:this.password};o.a.updateMobileByToken(t).then(t=>{200!==t.code?(this.error=t.msg,this.opacity=1):this.activeName="third"})}else this.error="密码不符合规则",this.opacity=1},validPhone:function(t){return/^1[3|4|5|6|7|8|9][0-9]\d{8}$/.test(t)},validPassword:function(){var t=/^(?!\d+$)(?![A-Za-z]+$)[a-zA-Z0-9]{6,30}$/;return t.test(this.password)&&t.test(this.rePassword)},inputFocus:function(){this.error="",this.opacity=0}}},r=(e(273),e(1)),c=Object(r.a)(n,i,[],!1,null,"2f345e8d",null);c.options.__file="src\\pages\\login\\forgot.vue";s.default=c.exports}}]);
//# sourceMappingURL=11.24ee6967.js.map