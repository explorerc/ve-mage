(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{605:function(t,e,a){},608:function(t,e,a){},863:function(t,e,a){"use strict";var i=a(605);a.n(i).a},869:function(t,e,a){"use strict";var i=a(608);a.n(i).a},915:function(t,e,a){"use strict";a.r(e);var i=a(98),s=a.n(i),l=a(493),n={data:function(){return{searchVal:"",restoreData:{id:[],name:[]},dataList:[],groupListData:[],tagListData:[],activelistData:[]}},created:function(){this.restoreData=this.checkedData},mounted:function(){switch(this.name){case"活动":this.dataList=this.activelistData,this.queryActList();break;case"标签":this.dataList=this.tagListData,this.queryTaglist();break;case"固定群组":this.dataList=this.groupListData,this.queryGrouplist()}},computed:{},props:{checkedData:{type:Object,default:function(){return{}}},max:{type:Number,default:3},name:{type:String,default:""}},methods:{close:function(){this.$emit("handleClick",{action:"cancel"})},confirm:function(){this.$emit("selectComConfirm",this.restoreData),this.close()},search:function(){this.$emit("searchHandler",this.searchVal)},selectCheck:function(t,e){var a={isChecked:t,id:e};this.regroupData(a,this.dataList)},regroupData:function(t,e){var a=this;e.forEach(function(i,s){i.id===t.id&&(e[s].checked=t.isChecked,t.isChecked?a.restoreData.name.push(i.name):a.restoreData.name.forEach(function(t,e){t===i.name&&a.restoreData.name.splice(e,1)}))})},queryTaglist:function(t){var e=this;this.$get(l.a.GET_TAG_LIST,{keyword:this.searchVal}).then(function(t){console.log(t.data.list),t.data.list.forEach(function(t){e.tagListData.push({name:t.tag_name,id:t.tag_id,checked:!1})})})},queryGrouplist:function(t){var e=this;this.$get(l.a.GET_GROUP_LIST,{keyword:this.searchVal,type:"1"}).then(function(t){t.data.list.forEach(function(t){e.groupListData.push({name:t.title+"("+t.user_count+")",id:t.group_id,checked:!1})})})},queryActList:function(){var t=this,e={keyword:this.searchVal,page:1,pageSize:30};this.$get(l.a.GET_ACTIVE_LIST,e).then(function(e){console.log(e.data.list),e.data.list.forEach(function(e){t.activelistData.push({name:e.title,id:e.id,checked:!1})})})}}},o=(a(863),a(2)),r=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"com-addChoose-wrap"},[a("div",{staticClass:"com-modal"}),t._v(" "),a("div",{staticClass:"com-addChoose-box"},[a("div",{staticClass:"header"},[a("span",{staticClass:"title"},[t._v("选择"+t._s(t.name))]),t._v(" "),a("button",{on:{click:t.close}},[a("i",{staticClass:"iconfont icon-close"})])]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"search-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchVal,expression:"searchVal"}],staticClass:"inp",attrs:{placeholder:"输入"+t.name+"名称"},domProps:{value:t.searchVal},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null},input:function(e){e.target.composing||(t.searchVal=e.target.value)}}})]),t._v(" "),a("el-checkbox-group",{class:"data-list",attrs:{max:t.max},model:{value:t.restoreData.id,callback:function(e){t.$set(t.restoreData,"id",e)},expression:"restoreData.id"}},[t.dataList.length<=0?a("span",{staticClass:"loading"},[t._v("加载中...")]):t._e(),t._v(" "),t._l(t.dataList,function(e,i){return a("el-checkbox",{key:i,attrs:{label:e.id,checked:e.checked},on:{change:function(a){t.selectCheck(a,e.id)}}},[t._v(t._s(e.name))])})],2),t._v(" "),a("div",{staticClass:"foot-box"},[a("span",{staticClass:"count"},[t._v("已选择 "),a("i",{class:{max:t.restoreData.id.length===t.max}},[t._v(t._s(t.restoreData.id.length))]),t._v(" 个"+t._s(t.name))]),t._v(" "),a("el-button",{staticClass:"primary-button confirm",on:{click:t.confirm}},[t._v("确定")])],1)],1)])])},[],!1,null,"6b3ade14",null);r.options.__file="com-choose.vue";var c=r.exports,d=a(644),u=a(485),v=a(643),h=[{id:1,name:"北京"},{id:2,name:"上海"},{id:3,name:"天津"},{id:4,name:"重庆"},{id:5,name:"河北"},{id:6,name:"山西"},{id:7,name:"内蒙古"},{id:8,name:"辽宁"},{id:9,name:"吉林"},{id:10,name:"黑龙江"},{id:11,name:"江苏"},{id:12,name:"浙江"},{id:13,name:"安徽"},{id:14,name:"福建"},{id:15,name:"江西"},{id:16,name:"山东"},{id:17,name:"河南"},{id:18,name:"湖北"},{id:19,name:"湖南"},{id:20,name:"广东"},{id:21,name:"广西"},{id:22,name:"海南"},{id:23,name:"四川"},{id:24,name:"贵州"},{id:25,name:"云南"},{id:26,name:"西藏"},{id:27,name:"陕西"},{id:28,name:"甘肃"},{id:29,name:"宁夏"},{id:30,name:"青海"},{id:31,name:"新疆"},{id:32,name:"香港"},{id:33,name:"澳门"},{id:34,name:"台湾"},{id:35,name:"海外"}],m={data:function(){return{filterVal:"",showFilter:!1,grands:[{value:"",label:"全部"},{value:1,label:"优质客户"},{value:2,label:"高价值用户"},{value:3,label:"一般用户"},{value:4,label:"潜在用户"},{value:5,label:"流失用户"},{value:0,label:"没有评级"}],grandVal:"",sources:[{value:"",label:"全部"},{value:"导入",label:"导入"},{value:"微信注册",label:"微信注册"},{value:"PC注册",label:"PC注册"}],sourcesVal:"",sexs:[{value:"",label:"全部"},{value:"M",label:"男"},{value:"W",label:"女"}],sexsVal:"",industrys:[{value:"",label:"全部"},{value:"IT/互联网",label:"IT/互联网"},{value:"电子/通信/硬件",label:"电子/通信/硬件"},{value:"金融",label:"金融"},{value:"交通/贸易/物流",label:"交通/贸易/物流"},{value:"消费品",label:"消费品"},{value:"机械/制造",label:"机械/制造"},{value:"能源/矿产环保",label:"能源/矿产环保"},{value:"制药/医疗",label:"制药/医疗"},{value:"专业服务",label:"专业服务"},{value:"教育/培训",label:"教育/培训"},{value:"广告/媒体/娱乐/出版",label:"广告/媒体/娱乐/出版"},{value:"房地产/建筑",label:"房地产/建筑"},{value:"服务业",label:"服务业"},{value:"政府/非盈利机构/其它",label:"政府/非盈利机构/其它"}],industrysVal:"",districts:[],districtsVal:[""],firstVal:[new Date(2018,10,10,10,10),new Date(2018,10,11,10,10)],lastVal:[new Date(2018,10,10,10,10),new Date(2018,10,11,10,10)],activityArray:{id:[],name:[]},tagArray:{id:[],name:[]},groupArray:{id:[],name:[]},usersListData:[],multipleSelection:[],total:7,currPage:1,totalPage:1,queryData:{page:1,pageSize:10},showAddgroup:!1,showChooseActive:!1,showChooseTag:!1,showChooseGroup:!1,showImport:!1,chooseType:"活动",filterCondition:{keyword:"",user_level:"",first_visited_at_start:"",first_visited_at_end:"",last_visited_at_start:"",last_visited_at_end:"",sex:"",province:"",city:"",industry:"",join_count:"",source:"",activity_ids:"",tags:"",groups:"",page:"",page_size:""}}},mounted:function(){this.queryUserPool(),this.districts=h},filters:{filterLevel:function(t){switch(t){case 1:return"优质客户";case 2:return"高价值用户";case 3:return"一般用户";case 4:return"潜在用户";case 5:return"流失用户";case 0:return"没有评级"}},filterLevelclass:function(t){switch(t){case 1:return"high";case 2:return"good";case 3:return"common";case 4:return"protential";case 5:case 0:return""}}},methods:{handleSelectionChange:function(t){this.multipleSelection=t},currentChange:function(t){s()(this.filterCondition,{page:t}),this.queryUserPool(this.filterCondition)},handleDel:function(t,e){this[e].name.splice(t,1),this[e].id.splice(t,1)},handleClick:function(t){"cancel"===t.action&&(this.showAddgroup=!1,this.showChooseActive=!1,this.showChooseTag=!1,this.showChooseGroup=!1,this.showImport=!1)},selectActiveConfirm:function(t){console.log(t),this.activityArray.name=t.name,this.activityArray.id=t.id,this.filterCondition.activity_ids=t.id.toString()},selectTagConfirm:function(t){console.log(t),this.tagArray.name=t.name,this.tagArray.id=t.id,this.filterCondition.tags=t.id.toString()},selectGroupConfirm:function(t){console.log(t),this.groupArray.name=t.name,this.groupArray.id=t.id,this.filterCondition.groups=t.id.toString()},handleDistrictChange:function(t){console.log(t),this.filterCondition.province=t[0],this.filterCondition.city=t[1]?t[1]:"",this.filterCondition.area=t[2]?t[2]:""},searchHandler:function(t){console.log(t)},groupData:function(t){console.log(t)},queryUserPool:function(t){var e=this;this.$get(l.a.GET_USERS_POOL,t).then(function(t){console.log(t),t.data.list.forEach(function(t){e.usersListData.push({avatar:t.avatar?t.avatar:"//cnstatic01.e.vhall.com/static/img/v35-webinar.png",name:t.real_name.length<=5?t.real_name:t.real_name.substr(0,5)+"...",gender:"M"===t.sex?"男":"女",phone:t.phone,mail:t.email,lastActive:t.last_visited_at,comment:t.remark,level:t.user_level,count:t.join_count})})})},doFilter:function(){console.log(this.filterCondition)},handleCommandk:function(t){switch(t){case"addGroup":this.showAddgroup=!0;break;case"checkCurPage":case"checkAll":this.multipleSelection=this.usersListData,document.querySelector(".table_box th.el-table_1_column_1 span.el-checkbox__inner").click()}}},watch:{firstVal:{handler:function(t){this.filterCondition.first_visited_at_start=t[0],this.filterCondition.first_visited_at_end=t[1]},immediate:!0},lastVal:{handler:function(t){this.filterCondition.last_visited_at_start=t[0],this.filterCondition.last_visited_at_end=t[1]},immediate:!0}},components:{VePagination:u.a,comAddgroup:d.a,comChoose:c,comImport:v.a}},p=(a(869),Object(o.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pond-page"},[t._m(0),t._v(" "),a("div",{staticClass:"content from-box"},[a("div",{staticClass:"handle-bar"},[a("div",{staticClass:"left"},[a("el-dropdown",{on:{command:t.handleCommandk}},[a("span",{staticClass:"el-dropdown-link"},[a("el-button",{attrs:{round:""}},[t._v("选择")])],1),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"checkCurPage"}},[t._v("本页数据")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"checkAll"}},[t._v("列表所有数据")])],1)],1),t._v(" "),a("el-dropdown",{on:{command:t.handleCommandk}},[a("span",{staticClass:"el-dropdown-link"},[a("el-button",{attrs:{round:""}},[t._v("批量操作")])],1),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"export"}},[t._v("导出")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"addGroup"}},[t._v("添加到群组")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"del"}},[t._v("删除")])],1)],1),t._v(" "),a("el-button",{attrs:{round:""},on:{click:function(e){t.showImport=!0}}},[t._v("批量导入")])],1),t._v(" "),a("div",{staticClass:"right"},[a("com-input",{attrs:{value:t.filterCondition.keyword,placeholder:"姓名/昵称/手机号/邮箱"},on:{"update:value":function(e){t.$set(t.filterCondition,"keyword",e)},focus:function(t){}}}),t._v(" "),a("span",{on:{click:function(e){t.showFilter=!t.showFilter}}},[t._v("精准搜索"),a("i",{staticClass:"el-submenu__icon-arrow el-icon-arrow-down",class:{"is-open":t.showFilter}})])],1)]),t._v(" "),a("transition",{attrs:{name:"left-right",mode:"out-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showFilter,expression:"showFilter"}],staticClass:"handle-filter page-bg"},[a("div",{staticClass:"filter-item"},[a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("用户级别")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filterCondition.user_level,callback:function(e){t.$set(t.filterCondition,"user_level",e)},expression:"filterCondition.user_level"}},t._l(t.grands,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("来源")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filterCondition.source,callback:function(e){t.$set(t.filterCondition,"source",e)},expression:"filterCondition.source"}},t._l(t.sources,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("参与场次")]),t._v(" "),a("com-input",{attrs:{type:"number",value:t.filterCondition.join_count,placeholder:"请输入参与活动次数"},on:{"update:value":function(e){t.$set(t.filterCondition,"join_count",e)}}})],1)]),t._v(" "),a("div",{staticClass:"filter-item"},[a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("所属地域")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.grandVal,callback:function(e){t.grandVal=e},expression:"grandVal"}},t._l(t.districts,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})}))],1),t._v(" "),a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("性别")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filterCondition.sex,callback:function(e){t.$set(t.filterCondition,"sex",e)},expression:"filterCondition.sex"}},t._l(t.sexs,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("所属行业")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.filterCondition.industry,callback:function(e){t.$set(t.filterCondition,"industry",e)},expression:"filterCondition.industry"}},t._l(t.industrys,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)]),t._v(" "),a("div",{staticClass:"filter-item"},[a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("首次访问")]),t._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd hh:mm",align:"left"},model:{value:t.firstVal,callback:function(e){t.firstVal=e},expression:"firstVal"}})],1),t._v(" "),a("div",{staticClass:"condition"},[a("span",{staticClass:"label"},[t._v("最后访问")]),t._v(" "),a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd hh:mm",align:"left"},model:{value:t.lastVal,callback:function(e){t.lastVal=e},expression:"lastVal"}})],1)]),t._v(" "),a("div",{staticClass:"filter-item"},[a("span",{staticClass:"label"},[t._v("参与活动")]),t._v(" "),t.activityArray.name.length?a("div",{staticClass:"selected"},[a("ol",{staticClass:"tag-box"},[t._l(t.activityArray.name,function(e,i){return a("li",{key:i,staticClass:"tag"},[t._v(t._s(e)+" "),a("span",{staticClass:"close",on:{click:function(e){t.handleDel(i,"activityArray")}}})])}),t._v(" "),a("li",{staticClass:"added",on:{click:function(e){t.showChooseActive=!0}}})],2)]):a("el-button",{attrs:{round:""},on:{click:function(e){t.showChooseActive=!0}}},[t._v("选择活动")])],1),t._v(" "),a("div",{staticClass:"filter-item"},[a("span",{staticClass:"label"},[t._v("活动标签")]),t._v(" "),t.tagArray.name.length?a("div",{staticClass:"selected"},[a("ol",{staticClass:"tag-box"},[t._l(t.tagArray.name,function(e,i){return a("li",{key:i,staticClass:"tag"},[t._v(t._s(e)+" "),a("span",{staticClass:"close",on:{click:function(e){t.handleDel(i,"tagArray")}}})])}),t._v(" "),a("li",{staticClass:"added",on:{click:function(e){t.showChooseTag=!0}}})],2)]):a("el-button",{attrs:{round:""},on:{click:function(e){t.showChooseTag=!0}}},[t._v("选择标签")])],1),t._v(" "),a("div",{staticClass:"filter-item"},[a("span",{staticClass:"label"},[t._v("所属群组")]),t._v(" "),t.groupArray.name.length?a("div",{staticClass:"selected"},[a("ol",{staticClass:"tag-box"},[t._l(t.groupArray.name,function(e,i){return a("li",{key:i,staticClass:"tag"},[t._v(t._s(e)+" "),a("span",{staticClass:"close",on:{click:function(e){t.handleDel(i,"groupArray")}}})])}),t._v(" "),a("li",{staticClass:"added",on:{click:function(e){t.showChooseGroup=!0}}})],2)]):a("el-button",{attrs:{round:""},on:{click:function(e){t.showChooseGroup=!0}}},[t._v("选择分组")])],1),t._v(" "),a("div",{staticClass:"filter-confirm"},[a("el-button",{staticClass:"primary-button",attrs:{round:""},on:{click:t.doFilter}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{round:""}},[t._v("取消")])],1)])]),t._v(" "),a("div",{staticClass:"users-list page-bg"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.usersListData,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"用户信息",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("dl",{staticClass:"users-info clearfix"},[a("dt",[a("img",{attrs:{src:e.row.avatar}})]),t._v(" "),a("dd",[a("span",{staticClass:"name"},[t._v(t._s(e.row.name))]),t._v(" "),a("span",{staticClass:"gender"},[t._v(t._s(e.row.gender))])]),t._v(" "),a("dd",{staticClass:"name",class:t._f("filterLevelclass")(e.row.level)},[t._v(t._s(t._f("filterLevel")(e.row.level)))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"手机号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"mail",label:"邮箱","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"count",label:"参与(次)",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"lastActive",label:"最后活跃",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"备注",width:"150","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"count",label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"detail",attrs:{type:"text",size:"small"},nativeOn:{click:function(a){a.preventDefault(),t.deleteRow(e.$index,t.tableData4)}}},[t._v("\n              详情\n            ")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-box"},[a("div",{staticClass:"page-pagination"},[a("ve-pagination",{attrs:{total:t.total,pageSize:t.queryData.pageSize,currentPage:t.currPage},on:{changePage:t.currentChange}})],1)])],1)],1),t._v(" "),t.showAddgroup?a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("com-addgroup",{on:{handleClick:t.handleClick,groupData:t.groupData}})],1):t._e(),t._v(" "),t.showChooseActive?a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("com-choose",{attrs:{checkedData:t.activityArray,max:10,name:"活动"},on:{handleClick:t.handleClick,selectComConfirm:t.selectActiveConfirm,searchHandler:t.searchHandler}})],1):t._e(),t._v(" "),t.showChooseTag?a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("com-choose",{attrs:{checkedData:t.tagArray,max:10,name:"标签"},on:{handleClick:t.handleClick,selectComConfirm:t.selectTagConfirm,searchHandler:t.searchHandler}})],1):t._e(),t._v(" "),t.showChooseGroup?a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("com-choose",{attrs:{checkedData:t.groupArray,max:10,name:"固定群组"},on:{handleClick:t.handleClick,selectComConfirm:t.selectGroupConfirm,searchHandler:t.searchHandler}})],1):t._e(),t._v(" "),t.showImport?a("transition",{attrs:{name:"fade",mode:"out-in"}},[a("com-import",{on:{handleClick:t.handleClick}})],1):t._e()],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pond-title"},[e("span",{staticClass:"title"},[this._v("用户池")])])}],!1,null,"4fb14740",null));p.options.__file="index.vue";e.default=p.exports}}]);