(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{542:function(t,i,s){},543:function(t,i,s){},716:function(t,i,s){"use strict";var e=s(542);s.n(e).a},717:function(t,i,s){"use strict";var e=s(543);s.n(e).a},861:function(t,i,s){"use strict";s.r(i);var e=function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"live-mager edit-step-box"},[t._m(0),t._v(" "),s("div",{staticClass:"tip-box"},[t._v("\n    通过邮件邀约，定制邀约邮件，邀请特定客户群参加直播活动\n  ")]),t._v(" "),s("div",{staticClass:"mager-box border-box"},[s("div",{staticClass:"from-box"},[s("div",{staticClass:"from-row"},[s("div",{staticClass:"from-title"},[t._v("邮件标题：")]),t._v(" "),s("div",{staticClass:"from-content"},[t._v(t._s(t.email.title))])]),t._v(" "),s("div",{staticClass:"from-row"},[s("div",{staticClass:"from-title"},[t._v("发件人：")]),t._v(" "),s("div",{staticClass:"from-content"},[t._v(t._s(t.email.senderName))])]),t._v(" "),s("div",{staticClass:"from-row"},[s("div",{staticClass:"from-title"},[t._v("收件人：")]),t._v(" "),s("div",{staticClass:"from-content receiver"},[t.selectedGroupList.length||t.selectedTagList.length?[s("div",t._l(t.selectedGroupList,function(i){return s("span",[t._v(t._s(i.name)+"（"+t._s(i.count)+"）、")])})),t._v(" "),s("div",[t._l(t.selectedTagList,function(i){return s("span",[t._v(t._s(i.name)+"、")])}),t._v("（合计"+t._s(t.email.sendCount)+"人）\n            ")],2),t._v(" "),s("el-button",{staticClass:"send-detail default-button",on:{click:function(i){t.sendDetail=!0}}},[t._v("发送详情")])]:[t._v("\n            暂未选择\n          ")]],2)]),t._v(" "),s("div",{staticClass:"from-row"},[s("div",{staticClass:"from-title"},[t._v("发件状态：")]),t._v(" "),s("div",{staticClass:"from-content"},["DRAFT"==t.email.status?s("span",{staticClass:"cg-status"},[s("i",{staticClass:"iconfont icon-shijian"}),t._v(t._s(t.email.statusName))]):t._e(),t._v(" "),"SEND"==t.email.status?s("span",{staticClass:"fs-status"},[s("i",{staticClass:"iconfont icon-shijian"}),t._v(t._s(t.email.statusName))]):t._e(),t._v(" "),"AWAIT"==t.email.status?s("span",{staticClass:"dd-status"},[s("i",{staticClass:"iconfont icon-shijian"}),t._v(t._s(t.email.statusName))]):t._e()])]),t._v(" "),s("div",{staticClass:"from-row"},[s("div",{staticClass:"from-title"},[t._v("发件时间：")]),t._v(" "),s("div",{staticClass:"from-content"},[t._v(t._s(t.email.sendTime))])]),t._v(" "),s("div",{staticClass:"from-row"},[s("div",{staticClass:"from-title"},[t._v("邮件摘要：")]),t._v(" "),s("div",{staticClass:"from-content"},[s("div",[t._v(t._s(t.email.desc))])])]),t._v(" "),s("div",{staticClass:"from-row"},[s("div",{staticClass:"email-info-box",domProps:{innerHTML:t._s(t.email.content)}})]),t._v(" "),s("div",{staticClass:"step-btns"},["SEND"!==t.email.status?s("button",{staticClass:"default-button margin-fl",on:{click:t.editEmail}},[t._v("编辑邮件")]):t._e(),t._v(" "),"AWAIT"==t.email.status?s("button",{staticClass:"primary-button",on:{click:t.sendEmail}},[t._v("立即发送")]):t._e()])])]),t._v(" "),t.sendDetail?s("transition",{attrs:{name:"fade",mode:"out-in"}},[s("com-detail",{attrs:{_type:"EMAIL"},on:{handleClick:t.handleClick}})],1):t._e()],1)};e._withStripped=!0;var a=s(97),n=s.n(a),o=s(136),l=s.n(o),r=s(30),c=s.n(r),u=s(471),d=s(469),m=s(95),v=s(15),f={DRAFT:"草稿",SEND:"已发送",AWAIT:"等待发送"},_={name:"info",data:function(){return{email:{activityId:0,emailInviteId:0,title:"",content:"",desc:"",planTime:"",sendTime:"",senderName:"",sendCount:0,status:"",statusName:""},selectedGroupList:[],selectedTagList:[],groupList:[],tagList:[],sendDetail:!1}},components:{comDetail:s(648).a},computed:Object(m.c)("liveMager",{emailInfo:function(t){return t.emailInfo}}),watch:{emailInfo:{handler:function(t){this.email=c()({},t)},immediate:!0}},created:function(){var t=this;if(this.email.emailInviteId){var i=this.emailInfo.groupIds?this.emailInfo.groupIds:[],s=this.emailInfo.tagIds?this.emailInfo.tagIds:[];return this.queryTagList().then(this.queryGroupList()).then(function(){t.reArrangeList(i.split(","),s.split(","))}),!1}this.$route.params.id?(this.email.emailInviteId=this.$route.query.email,this.queryTagList().then(this.queryGroupList()).then(this.queryEmailInfo())):this.$router.go(-1)},methods:c()({},Object(m.b)("liveMager",{storeEmailInfo:v.d}),{queryEmailInfo:function(){var t=this;this.email.emailInviteId&&this.$get(d.a.GET_EMAIL_INFO,{emailInviteId:this.email.emailInviteId}).then(function(i){i.data.statusName=f[i.data.status],t.email=i.data,setTimeout(function(){t.reArrangeList(i.data.groupIds.split(","),i.data.tagIds.split(","))},500),t.storeEmailInfo(t.email)})},sendEmail:function(){this.$post(d.a.POST_SEND_EMAIL_INFO,{emailInviteId:this.email.emailInviteId}).then(function(t){console.log("邮件发送成功"),console.log(t)})},editEmail:function(){this.$router.push("/liveMager/emailEditOne/"+this.email.activityId+"?email="+this.email.emailInviteId)},prePage:function(){this.$router.go(-1)},queryGroupList:function(t){var i=this;return l()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.$get(u.a.GET_GROUP_LIST,{type:"2"}).then(function(t){var s=[];t.data.list.forEach(function(t){s.push({id:t.group_id,name:t.title,count:t.user_count,isChecked:!1})}),i.groupList=s});case 2:case"end":return t.stop()}},t,i)}))()},queryTagList:function(){var t=this;return l()(n.a.mark(function i(){return n.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.$get(u.a.GET_TAG_LIST).then(function(i){var s=[];i.data.list.forEach(function(t){s.push({name:t.tag_name,id:t.tag_id,isChecked:!1})}),t.tagList=s});case 2:case"end":return i.stop()}},i,t)}))()},reArrangeList:function(t,i){var s=this;this.groupList.forEach(function(i,e){t.forEach(function(t,e){1*t===i.id&&s.selectedGroupList.push({count:0,id:i.id,isChecked:!0,name:i.name})})}),this.tagList.forEach(function(t,e){i.forEach(function(i,e){1*i===t.id&&s.selectedTagList.push({count:0,id:t.id,isChecked:!0,name:t.name})})})},handleClick:function(t){"cancel"===t.action&&(this.sendDetail=!1)}})},h=(s(716),s(717),s(2)),p=Object(h.a)(_,e,[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"live-title"},[i("span",{staticClass:"title"},[this._v("查看邮件")])])}],!1,null,"306415dd",null);p.options.__file="src/pages/live-mager/email/info.vue";i.default=p.exports}}]);
//# sourceMappingURL=18.01af986f.js.map