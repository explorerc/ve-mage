(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{185:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"goods-info"}},[r("header",[e._v("编辑粉丝信息\n    "),r("com-back")],1),e._v(" "),r("el-form",{ref:"userData",staticClass:"demo-ruleForm",attrs:{model:e.userData,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"用户ID：",prop:"id"}},[r("el-input",{staticClass:"slot_inp_b",attrs:{disabled:"disabled"},model:{value:e.userData.id,callback:function(t){e.$set(e.userData,"id",t)},expression:"userData.id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"粉丝姓名：",prop:"name"}},[r("el-input",{staticClass:"slot_inp_b",model:{value:e.userData.name,callback:function(t){e.$set(e.userData,"name",t)},expression:"userData.name"}},[r("template",{staticClass:"slot",slot:"append"},[e.userData.name.gbLength()>0?r("span",{staticStyle:{color:"#4b5afe"},domProps:{textContent:e._s(e.userData.name.gbLength())}}):e._e(),0==e.userData.name.gbLength()?r("span",{staticStyle:{color:"#999"},domProps:{textContent:e._s(e.userData.name.gbLength())}}):e._e(),e._v("/20")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"openID：",prop:"openId"}},[r("el-input",{staticClass:"slot_inp_b",attrs:{disabled:"disabled"},model:{value:e.userData.openId,callback:function(t){e.$set(e.userData,"openId",t)},expression:"userData.openId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"粉丝昵称：",prop:"nickname"}},[r("div",{staticClass:"a_unit"},[r("el-input",{attrs:{placeholder:"请输入粉丝昵称"},model:{value:e.userData.nickname,callback:function(t){e.$set(e.userData,"nickname",e._n(t))},expression:"userData.nickname"}})],1)]),e._v(" "),r("el-form-item",{attrs:{label:"地址：",prop:"address"}},[r("div",{staticClass:"a_unit"},[r("el-input",{attrs:{placeholder:"请输入地址"},model:{value:e.userData.address,callback:function(t){e.$set(e.userData,"address",e._n(t))},expression:"userData.address"}})],1)]),e._v(" "),r("el-form-item",{attrs:{label:"联系：",prop:"address"}},[r("div",{staticClass:"a_unit"},[r("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.userData.tel,callback:function(t){e.$set(e.userData,"tel",e._n(t))},expression:"userData.tel"}})],1)]),e._v(" "),r("el-form-item",{attrs:{label:"postCode：",prop:"inventory",disabled:""}},[r("div",{staticClass:"a_unit"},[r("el-input",{attrs:{disabled:"true"},model:{value:e.userData.podtCode,callback:function(t){e.$set(e.userData,"podtCode",e._n(t))},expression:"userData.podtCode"}}),e._v(" "),r("span",[e._v("件")])],1)]),e._v(" "),r("el-form-item",{staticClass:"btns_box"},[r("el-button",{staticClass:"add-goods primary-button",attrs:{type:"primary",round:""},on:{click:function(t){e.onSubmit("goodsData")}}},[e._v("保存")]),e._v(" "),r("el-button",{attrs:{round:""},on:{click:function(t){e.resetForm("goodsData")}}},[e._v("取消")])],1)],1)],1)};a._withStripped=!0;var n=r(60),i=r.n(n),o=r(213),s=r(201),l=r(59),u={name:"info",watch:{goodsData:{handler:function(){this.initReady&&(this.isShowMsgB=!0)},deep:!0}},created:function(){var e=this;"update"===this.$route.params.type?(this.getGoodsDetail(),this.Breadcrumb="编辑商品"):this.Breadcrumb="新建商品",this.$nextTick(function(){e.initReady=!0})},mounted:function(){l.a.$emit("breads",[{title:"商品管理"},{title:"商品列表",url:"/goodMager/list"},{title:this.Breadcrumb,url:"/goodMager/edit/"+this.$route.params.type}])},components:{VeUpload:o.a},computed:{defaultImg:function(){return this.poster?this.$imgHost+"/"+this.poster:""}},data:function(){var e=this;return{timerVail:null,timer:null,tipsShow:!0,Breadcrumb:"",isShowMsgB:!1,errTitle:"",imgEmptyMsg:"",goodId:this.$route.params.id,goodsData:{name:"",price:"",imgUrl:[{errMsg:""}],disprice:"",describe:"",inventory:null,added:"1"},rules:{name:[{required:!0,validator:function(t,r,a){console.log(r),e.timerVail||(e.timerVail=setTimeout(function(){if(clearTimeout(e.timerVail),e.timerVail=null,!r)return a(new Error("商品名称不能为空"));if(r.gbLength()<t.min)return a(new Error("商品名称过短"));if(r.gbLength()>t.max){for(var n in e[t.obj])if(n===t.field)return e[t.obj][n]=r.slice(0,r.gbIndex(t.max)+1),a()}else a()},500))},min:3,max:20,trigger:"change",obj:"goodsData"}],price:[{validator:function(e,t,r){return"number"!=typeof t||!t&&0!==t?r(new Error("请输入原始价格")):t<0||t>=999999?r(new Error("原始价格应大于0小于999999")):String(t).indexOf(".")>-1&&String(t).slice(String(t).indexOf(".")+1).length>2?r(new Error("价格最多为小数点后两位")):r()},type:"number",min:0,max:999999,trigger:"change",obj:"goodsData"}],preferential:[{validator:function(t,r,a){if(r){if("number"==typeof r){var n=e[t.obj].price;return r&&r<0?a(new Error("优惠价格不能小于0")):r&&n&&r>=n?a(new Error("优惠价格需小于原始价格")):String(r).indexOf(".")>-1&&String(r).slice(String(r).indexOf(".")+1).length>2?a(new Error("优惠价格最多为小数点后两位")):r&&!n?a(new Error("请先填写原始价格")):a()}return a(new Error("请输入优惠价格"))}return a()},type:"number",min:0,max:999999,trigger:"change",obj:"goodsData"}],inventory:[{validator:function(e,t,r){return"number"!=typeof t||!t&&0!==t?r(new Error("请输入现有库存")):t<0||t>=999999?r(new Error("现有库存应大于0小于999999")):String(t).indexOf(".")>-1&&String(t).slice(String(t).indexOf(".")+1).length>=1?r(new Error("库存量应为整数")):r()},type:"number",min:0,max:999999,trigger:"change",obj:"goodsData"}],imgUrl:[{required:!0,validator:function(t,r,a){var n=0;return e[t.obj].imgUrl.map(function(e){e.name&&(n+=1)}),n>0?r[0].name?a():(e.imgEmptyMsg="请上传封面图",a(new Error("请上传封面图"))):(e.imgEmptyMsg="请上传图片",a(new Error("请上传图片")))},trigger:"blur",obj:"goodsData"}]}}},methods:{getGoodsDetail:function(){var e=this,t={goodId:this.goodId};this.$get(s.a.GET_GOOD_BYID,t).then(function(t){200===t.code&&(e.goodsData=t.data)}),console.log(this.goodId)},onSubmit:function(e){var t=this;this.timer||(this.timer=setTimeout(function(){clearTimeout(t.timer),t.timer=null,t.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var r=void 0;"create"===t.$route.params.type?r=s.a.CREATE_GOODS:(t.goodsData.goods_id=t.$route.params.id,r=s.a.UPDATE_GOODS);var a=t.goodsData.imgUrl.filter(function(e,t){if(e.name)return e});t.goodsData.image=i()(a),console.log(r)})},100))},resetForm:function(e){this.$router.go(-1)},uploadImgSuccess:function(e){e.errMsg="",this.goodsData.imgUrl[e.nowIndex].name=e.name},uploadError:function(e,t,r){this.imgEmptyMsg="",t.errMsg=e.msg}},beforeRouteLeave:function(e,t,r){this.isShowMsgB?this.$messageBox({header:"提示",width:"400px",content:"是否放弃当前编辑？",cancelText:"否",confirmText:"是",handleClick:function(e){"confirm"===e.action?r(!0):r(!1)}}):r(!0)}},d=(r(234),r(235),r(0)),c=Object(d.a)(u,a,[],!1,null,"9e91ab32",null);c.options.__file="src/pages/user-mager/edit.vue";t.default=c.exports},210:function(e,t,r){},211:function(e,t,r){},234:function(e,t,r){"use strict";var a=r(210);r.n(a).a},235:function(e,t,r){"use strict";var a=r(211);r.n(a).a}}]);
//# sourceMappingURL=14.877c256b.js.map