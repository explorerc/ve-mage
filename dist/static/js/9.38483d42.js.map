{"version":3,"sources":["webpack:///./src/pages/barrage/index.vue?11db","webpack:///./src/pages/barrage/index.vue?dd58","webpack:///./src/components/barrage/Tween.js","webpack:///./src/components/barrage/NormalRenderer.js","webpack:///./src/components/barrage/BaseRenderer.js","webpack:///./src/components/barrage/Barrage.js","webpack:///./src/pages/barrage/index.vue?2871","webpack:///src/pages/barrage/index.vue","webpack:///./src/pages/barrage/index.vue"],"names":["_node_modules_mini_css_extract_plugin_0_4_4_mini_css_extract_plugin_dist_loader_js_node_modules_css_loader_1_0_0_css_loader_index_js_node_modules_vue_loader_15_4_2_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_2_1_6_postcss_loader_lib_index_js_node_modules_sass_loader_7_1_0_sass_loader_lib_loader_js_node_modules_vue_loader_15_4_2_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","n","render","_vm","this","_h","$createElement","_c","_self","ref","staticClass","attrs","width","height","_v","clearable","on","click","start","_s","fps","to","_withStripped","Tween","t","b","c","d","type","trail","linear","easeIn","easeOut","easeInOut","_len","arguments","length","data","Array","_key","apply","_len2","_key2","_len3","_key3","_len4","_key4","prototype","Linear","EaseIn","EaseOut","EaseInOut","NormalRenderer","cvs","opt","undefined","classCallCheck_default","_this","possibleConstructorReturn_default","__proto__","get_prototype_of_default","call","itemPool","tweenType","tweenMethod","tween","duration","offsetYPercent","fillPercent","changeStyle","_calcRow","opts","globalHeight","fontSize","globalFamily","fontFamily","globalStyle","fontColor","opacity","gap","globalChanged","w","h","get_default","initStyle","_pause","ctx","clearRect","save","len","i","item","elapsedTime","x","fillStyle","_recycle","splice","fillText","y","restore","_mergeFont","font","globalFont","textBaseline","globalColor","globalAlpha","content","itemData","shift","assign_default","measureText","Math","random","_randomRow","_data","push","row","fillHeight","totalRows","floor","rowId","BaseRenderer","canvas","getContext","Proxy","get","target","key","bind","requestAnimationFrame","window","webkitRequestAnimationFrame","loop","symbol_default","Barrage","barrages","_fps","renderers","running","elapsed","Date","getTime","now","forEach","renderer","update","r","clientWidth","clientHeight","id","add","console","log","pause","resume","destroy","pages_barragevue_type_script_lang_js_","created","barrageSystem","barrage_Barrage","mounted","methods","$refs","registRenderer","addBarrage","setInterval","component","Object","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"static/js/9.38483d42.js","sourcesContent":["import mod from \"-!../../../node_modules/_mini-css-extract-plugin@0.4.4@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@1.0.0@css-loader/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@2.1.6@postcss-loader/lib/index.js!../../../node_modules/_sass-loader@7.1.0@sass-loader/lib/loader.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../node_modules/_mini-css-extract-plugin@0.4.4@mini-css-extract-plugin/dist/loader.js!../../../node_modules/_css-loader@1.0.0@css-loader/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/_postcss-loader@2.1.6@postcss-loader/lib/index.js!../../../node_modules/_sass-loader@7.1.0@sass-loader/lib/loader.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=css&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"section\", [\n    _c(\"canvas\", {\n      ref: \"cvs\",\n      staticClass: \"cvs\",\n      attrs: { width: \"800px\", height: \"500px\" }\n    }),\n    _vm._v(\" \"),\n    _c(\n      \"div\",\n      [\n        _c(\"el-input\", { attrs: { clearable: \"\" } }),\n        _vm._v(\" \"),\n        _c(\"el-button\", { on: { click: _vm.start } }, [_vm._v(\"添加\")]),\n        _vm._v(\" \"),\n        _c(\"span\", [_vm._v(_vm._s(_vm.fps))])\n      ],\n      1\n    ),\n    _vm._v(\" \"),\n    _c(\"div\", [_c(\"span\", [_vm._v(_vm._s(_vm.to))])])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","/**\r\n * 缓动类\r\n *\r\n * @export\r\n * @class Tween\r\n * @author zhenliang.sun\r\n * @date 2018-08-11 14:12:48\r\n */\r\nexport default class Tween {\r\n  // 线性缓动\r\n  linear (t, b, c, d) {\r\n    let x = c * t / d + b\r\n    return x\r\n  }\r\n\r\n  quart (type, ...data) {\r\n    let linear = this.linear\r\n    const trail = {\r\n      linear: linear,\r\n      easeIn: (t, b, c, d) => c * (t /= d) * t + b,\r\n      easeOut: (t, b, c, d) => -c * (t /= d) * (t - 2) + b,\r\n      easeInOut: (t, b, c, d) => {\r\n        if ((t /= d / 2) < 1) {\r\n          return c / 2 * t * t + b\r\n        }\r\n        return -c / 2 * ((--t) * (t - 2) - 1) + b\r\n      }\r\n\r\n    }\r\n    return !!trail[type] && trail[type](...data)\r\n  }\r\n\r\n  quad (type, ...data) {\r\n    let linear = this.linear\r\n\r\n    const trail = {\r\n\r\n      linear: linear,\r\n      easeIn: (t, b, c, d) => c * (t /= d) * t + b,\r\n      easeOut: (t, b, c, d) => -c * (t /= d) * (t - 2) + b,\r\n      easeInOut: (t, b, c, d) => {\r\n        if ((t /= d / 2) < 1) {\r\n          return c / 2 * t * t + b\r\n        }\r\n        return -c / 2 * ((--t) * (t - 2) - 1) + b\r\n      }\r\n    }\r\n    return !!trail[type] && trail[type](...data)\r\n  }\r\n\r\n  cubic (type, ...data) {\r\n    let linear = this.linear\r\n\r\n    const trail = {\r\n      linear: linear,\r\n      easeIn: (t, b, c, d) => c * (t /= d) * t * t + b,\r\n      easeOut: (t, b, c, d) => c * ((t = t / d - 1) * t * t + 1) + b,\r\n      easeInOut: (t, b, c, d) => {\r\n        if ((t /= d / 2) < 1) {\r\n          return c / 2 * t * t * t + b\r\n        }\r\n        return c / 2 * ((t -= 2) * t * t + 2) + b\r\n      }\r\n    }\r\n    return !!trail[type] && trail[type](...data)\r\n  }\r\n\r\n  quint (type, ...data) {\r\n    let linear = this.linear\r\n\r\n    const trail = {\r\n      linear: linear,\r\n      easeIn: (t, b, c, d) => c * (t /= d) * t * t * t * t + b,\r\n      easeOut: (t, b, c, d) => c * ((t = t / d - 1) * t * t * t * t + 1) + b,\r\n      easeInOut: (t, b, c, d) => {\r\n        if ((t /= d / 2) < 1) {\r\n          return c / 2 * t * t * t * t * t + b\r\n        }\r\n        return c / 2 * ((t -= 2) * t * t * t * t + 2) + b\r\n      }\r\n    }\r\n    return !!trail[type] && trail[type](...data)\r\n  }\r\n}\r\n\r\nTween.prototype.Linear = 'linear'\r\nTween.prototype.EaseIn = 'easeIn'\r\nTween.prototype.EaseOut = 'easeOut'\r\nTween.prototype.EaseInOut = 'easeInOut'\r\n","import BaseRenderer from './BaseRenderer'\r\n\r\n/**\r\n * 基础文本渲染器\r\n *      用于渲染纯文字\r\n * @export\r\n * @class NormalRenderer\r\n * @extends {BaseRenderer}\r\n * @author zhenliang.sun\r\n */\r\nexport default class NormalRenderer extends BaseRenderer {\r\n  constructor (cvs, opt = {}) {\r\n    super(cvs, opt)\r\n    this.type = 'NORMAL-RENDERER'\r\n    this.itemPool = []\r\n    this.tweenType = opt.tweenType || 'quad'\r\n    this.tweenMethod = opt.tweenMethod || this.tween.Linear\r\n    this.duration = opt.duration || 5000\r\n    this.offsetYPercent = opt.offsetYPercent || 0.1\r\n    this.fillPercent = opt.fillPercent || 0.8\r\n    this.changeStyle(opt)\r\n    this._calcRow()\r\n  }\r\n\r\n  changeStyle (opts = {}) {\r\n    // 文本属性保存\r\n    this.globalHeight = opts.fontSize || this.globalHeight || 18\r\n    this.globalFamily = opts.fontFamily || this.globalFamily || 'Microsoft YaHei'\r\n    this.globalStyle = opts.fontColor || this.globalStyle || '#ffffff'\r\n    this.opacity = opts.opacity || this.opacity || 1\r\n    this.gap = opts.gap || this.gap || 3\r\n    this.globalChanged = true\r\n  }\r\n\r\n  update (w, h, t) {\r\n    super.update(w, h, t)\r\n\r\n    this.globalChanged && this.initStyle()\r\n    // 暂停状态不进行任何渲染\r\n    if (this._pause) {\r\n      return\r\n    }\r\n\r\n    this.ctx.clearRect(0, 0, w, h)\r\n    this.ctx.save()\r\n\r\n    // fill text\r\n    let len = this.data.length\r\n    for (let i = 0; i < len; i++) {\r\n      let item = this.data[i]\r\n      if (!item) {\r\n        continue\r\n      }\r\n      // 更新item数据\r\n      item.elapsedTime += t\r\n      // elapsedTime,start,dist,duration\r\n      item.x = this.tween[this.tweenType](this.tweenMethod, item.elapsedTime, w, -item.width - w, item.duration)\r\n      this.ctx.fillStyle = item.fillStyle\r\n      // 边界检查、回收\r\n      if (item.x < -item.width) {\r\n        this._recycle(item)\r\n        this.data.splice(i, 1)\r\n        len--\r\n        continue\r\n      }\r\n      // 绘制\r\n      this.ctx.fillText(item.data, item.x, item.y)\r\n    }\r\n\r\n    this.ctx.restore()\r\n  }\r\n\r\n  initStyle () {\r\n    super.initStyle()\r\n    this.globalChanged = false\r\n    // 合并font属性\r\n    this._mergeFont()\r\n\r\n    // 更新全局样式\r\n    this.ctx.font = this.globalFont\r\n    this.ctx.textBaseline = 'middle'\r\n    this.ctx.fillStyle = this.globalColor\r\n    this.ctx.globalAlpha = this.opacity\r\n  }\r\n\r\n  add (content, opts) {\r\n    super.add(content, opts)\r\n    let itemData = this.itemPool.length > 0 ? this.itemPool.shift() : {}\r\n    Object.assign(itemData, opts)\r\n    // 计算宽度\r\n    if (this.ctx) {\r\n      itemData.width = this.ctx.measureText(content).width || 200\r\n    }\r\n    itemData.elapsedTime = 0\r\n    itemData.data = content\r\n    itemData.height = this.globalHeight\r\n    itemData.duration = this.duration - (Math.random() * this.duration / 3) >> 0\r\n    itemData.fillStyle = opts.fillStyle || this.globalStyle\r\n    // 计算轨道\r\n    itemData.y = this._randomRow()\r\n    this._data.push(itemData)\r\n  }\r\n\r\n  destroy () {\r\n    super.destory()\r\n    this.itemPool = []\r\n    this._data = []\r\n  }\r\n\r\n  _mergeFont () {\r\n    this.globalFont = `${this.globalHeight}px ${this.globalFamily}`\r\n  }\r\n\r\n  _recycle (item) {\r\n    item.elapsedTime = 0\r\n    item.width = 0\r\n    item.height = 0\r\n    item.data = ''\r\n    item.x = 0\r\n    item.y = 0\r\n    item.row = -1\r\n    item.duration = 0\r\n    item.fillStyle = ''\r\n    this.itemPool.push(item)\r\n  }\r\n\r\n  _calcRow () {\r\n    // this.offsetYPercent // 距离上边距百分比\r\n    // this.height // 当前显示区域的高度\r\n    // this.fillPercent // 填充多少\r\n    // this.gap // 行间距\r\n    // this.globalHeight // 行高\r\n    /*\r\n    ------------------------\r\n    |  | offsetYPercent\r\n    |       ---------------\r\n    |       |\r\n    |       | fillPercent\r\n    |       ---------------\r\n    |\r\n    ----------------------------\r\n    */\r\n    let fillHeight = this.height * this.fillPercent\r\n    this.totalRows = Math.floor(fillHeight / (this.globalHeight + this.gap))\r\n  }\r\n\r\n  _randomRow () {\r\n    let rowId = Math.floor(Math.random() * this.totalRows)\r\n    let offsetY = this.height * this.offsetYPercent\r\n    let ypos = rowId * (this.globalHeight + this.gap)\r\n    return offsetY + ypos\r\n  }\r\n}\r\n","import Tween from './Tween'\r\n\r\n/**\r\n * 基础渲染器\r\n *\r\n * @export\r\n * @class BaseRenderer\r\n * @author zhenliang.sun\r\n */\r\nexport default class BaseRenderer {\r\n  constructor (cvs, opt = {}) {\r\n    this.type = 'BASE-RENDERER'\r\n    this.canvas = cvs\r\n    this.opt = opt\r\n    this.ctx = this.canvas.getContext('2d')\r\n    this.width = this.canvas.width\r\n    this.height = this.canvas.height\r\n    // 渲染数据的对象池\r\n    this.itemPool = []\r\n    this._data = []\r\n    this._pause = false\r\n\r\n    this.tween = new Proxy(new Tween(), {\r\n      get: (target, key) => {\r\n        if (typeof target[key] === 'function') { return target[key].bind(target) }\r\n        return target[key]\r\n      }\r\n    })\r\n  }\r\n\r\n  update (w, h, t) {}\r\n\r\n  initStyle () {\r\n\r\n  }\r\n\r\n  pause () {\r\n    this._pause = true\r\n  }\r\n\r\n  resume () {\r\n    this._pause = false\r\n  }\r\n\r\n  destory () {\r\n\r\n  }\r\n\r\n  add (content, opts) {\r\n\r\n  }\r\n\r\n  clearRect () {\r\n    this.ctx.clearRect(0, 0, this.width, this.height)\r\n  }\r\n\r\n  resize (w, h) {\r\n    this.canvas.width = w\r\n    this.canvas.height = h\r\n    this.width = w\r\n    this.height = h\r\n  }\r\n\r\n  invalidateSize () {\r\n    this.globalChanged = true\r\n  }\r\n\r\n  get data () {\r\n    return this._data || []\r\n  }\r\n}\r\n","import NormalRenderer from './NormalRenderer'\r\n\r\n/**\r\n * 弹幕管理类\r\n *\r\n * @export\r\n * @class Barrage\r\n * @author zhenliang.sun\r\n * @date 2018-08-11 14:12:38\r\n */\r\n\r\nconst requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame\r\n// 私有函数内部循环\r\nconst loop = Symbol('barrage-loop')\r\n\r\nexport default class Barrage {\r\n  constructor () {\r\n    // 把注册进来的弹幕弹层挂载到windows.barrages下面\r\n    window.barrages = []\r\n    // 帧率显示\r\n    this._fps = 0\r\n    this.renderers = []\r\n    this.running = false\r\n    this[loop]()\r\n  }\r\n\r\n  [loop] (elapsed = new Date().getTime()) {\r\n    let now = new Date().getTime()\r\n    if (!this.running) {\r\n      this.renderers.forEach(renderer => {\r\n        let r = renderer.renderer\r\n        r.clearRect()\r\n      })\r\n      return\r\n    }\r\n    let elapsedTime = now - elapsed\r\n    let w = this.width\r\n    let h = this.height\r\n    this.renderers.forEach(renderer => {\r\n      let r = renderer.renderer\r\n      r.update(w, h, elapsedTime)\r\n    })\r\n    this._fps = 1000 / elapsedTime >> 0\r\n    requestAnimationFrame(() => this[loop](now))\r\n  }\r\n\r\n  /**\r\n   * 注册渲染器\r\n   *\r\n   * @memberof Barrage\r\n   */\r\n  registRenderer (type, canvas, opt = {}) {\r\n    let r\r\n\r\n    this.width = canvas.clientWidth\r\n    this.height = canvas.clientHeight\r\n\r\n    switch (type) {\r\n      case 'normal':\r\n        r = new NormalRenderer(canvas, opt)\r\n        break\r\n      default:\r\n        break\r\n    }\r\n\r\n    if (r === null) {\r\n      return\r\n    }\r\n\r\n    let renderer = {\r\n      id: type + Math.random() * 100 >> 0,\r\n      type: type,\r\n      renderer: r\r\n    }\r\n    window.barrages.push(canvas)\r\n    this.renderers.push(renderer)\r\n  }\r\n\r\n  /**\r\n   *\r\n   *\r\n   * @param {*} content\r\n   * @param {string} [type=\"normal\"]\r\n   * @param {*} [opts={}]\r\n   * @memberof Barrage\r\n   */\r\n  add (content, type = 'normal', opts = {}) {\r\n    this.renderers.forEach(renderer => {\r\n      if (renderer.type === type) {\r\n        let r = renderer.renderer\r\n        r.add(content, opts)\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   *\r\n   * 整体开始\r\n   * @returns\r\n   * @memberof Barrage\r\n   */\r\n  start () {\r\n    if (this.running) {\r\n      return\r\n    }\r\n\r\n    this.running = true\r\n    console.log('[barrage] start')\r\n    this[loop]()\r\n  }\r\n\r\n  /**\r\n   *\r\n   * 整体停止\r\n   * @memberof Barrage\r\n   */\r\n  stop () {\r\n    this.running = false\r\n    console.log('[barrage] stop')\r\n  }\r\n\r\n  /**\r\n   *\r\n   * 整体暂停\r\n   * @memberof Barrage\r\n   */\r\n  pause () {\r\n    this.renderers.forEach(renderer => {\r\n      let r = renderer.renderer\r\n      r.pause()\r\n    })\r\n    console.log('[barrage] pause')\r\n  }\r\n\r\n  /**\r\n   *\r\n   * 整体恢复\r\n   * @memberof Barrage\r\n   */\r\n  resume () {\r\n    this.renderers.forEach(renderer => {\r\n      let r = renderer.renderer\r\n      r.resume()\r\n    })\r\n    console.log('[barrage] resume')\r\n  }\r\n\r\n  destroy () {\r\n    this.renderers.forEach(renderer => {\r\n      let r = renderer.renderer\r\n      r.clearRect()\r\n      r.destroy()\r\n    })\r\n\r\n    this.renderers = []\r\n    this.running = false\r\n    this._fps = 0\r\n    console.log('[barrage] destroy')\r\n  }\r\n\r\n  /**\r\n   *\r\n   * 获取当前弹幕的fps\r\n   * @readonly\r\n   * @memberof Barrage\r\n   */\r\n  get fps () {\r\n    return this._fps\r\n  }\r\n}\r\n","import mod from \"-!../../../node_modules/_babel-loader@7.1.5@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_babel-loader@7.1.5@babel-loader/lib/index.js!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","<template>\r\n  <section>\r\n    <canvas ref=\"cvs\"\r\n            class=\"cvs\"\r\n            width=\"800px\"\r\n            height=\"500px\"></canvas>\r\n    <!-- width=\"800px\" height=\"400px\" -->\r\n    <div>\r\n      <el-input clearable></el-input>\r\n      <el-button @click=\"start\">添加</el-button>\r\n      <span>{{fps}}</span>\r\n    </div>\r\n    <div>\r\n      <span>{{to}}</span>\r\n      <!-- <el-button @click=\"countTO\">to 100</el-button> -->\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script>\r\nimport Barrage from '../../components/barrage/Barrage.js'\r\n// import CountTo from '../../utils/countTo.js'\r\nexport default {\r\n  created () {\r\n    this.barrageSystem = new Barrage()\r\n  },\r\n  mounted () {\r\n  },\r\n  data () {\r\n    return {\r\n      to: 0,\r\n      fps: 0\r\n    }\r\n  },\r\n  methods: {\r\n    start () {\r\n      let c = this.$refs.cvs\r\n      this.barrageSystem.registRenderer('normal', c, {})\r\n      // debugger\r\n      this.addBarrage()\r\n\r\n      this.barrageSystem.start()\r\n    },\r\n    addBarrage () {\r\n      setInterval(() => {\r\n        this.barrageSystem.add(Math.random())\r\n      }, 50)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.cvs {\r\n  /* width: 800px;\r\n  height: 400px; */\r\n  background-color: pink;\r\n}\r\n</style>\r\n","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=381d568f&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.4.2@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"E:\\\\project\\\\fe_management\\\\node_modules\\\\_vue-hot-reload-api@2.3.1@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('381d568f', component.options)\n    } else {\n      api.reload('381d568f', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=381d568f&\", function () {\n      api.rerender('381d568f', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pages/barrage/index.vue\"\nexport default component.exports"],"sourceRoot":""}